<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>gromacs下蛋白-配体复合物模拟[GAFF] | 小康博客 | 计算化学与分子模拟爱好者</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Gromacs">
    <meta name="description" content="gromacs小分子的配体的电荷问题一直时gromacs模拟蛋白-配体复合物中的难点与重点～网上有许多相关方面的教程，但是都没有成为系统，应李继存老师之邀，把最近摸索的方法过程总结出来，分享给大家～感谢网络上的朋友对我的帮助～ 我们以我现在在做的蛋白配体复合物进行模拟，蛋白质为AhR的PAS-B结构域，其是AhR转录因子的配体结合区～TCDD复合物是AhR的经典激动剂。 由于AhR晶体结构并未解析">
<meta name="keywords" content="Gromacs">
<meta property="og:type" content="article">
<meta property="og:title" content="gromacs下蛋白-配体复合物模拟[GAFF]">
<meta property="og:url" content="http://kangsgo.com/94.html">
<meta property="og:site_name" content="小康博客">
<meta property="og:description" content="gromacs小分子的配体的电荷问题一直时gromacs模拟蛋白-配体复合物中的难点与重点～网上有许多相关方面的教程，但是都没有成为系统，应李继存老师之邀，把最近摸索的方法过程总结出来，分享给大家～感谢网络上的朋友对我的帮助～ 我们以我现在在做的蛋白配体复合物进行模拟，蛋白质为AhR的PAS-B结构域，其是AhR转录因子的配体结合区～TCDD复合物是AhR的经典激动剂。 由于AhR晶体结构并未解析">
<meta property="og:locale" content="zh">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/vmdscene.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/topol.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/2.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/potential.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/potential2.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/3.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/4.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/template.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/pressure.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/density.png">
<meta property="og:image" content="http://kangsgo.com/images/2015/12/5.png">
<meta property="og:updated_time" content="2017-12-21T11:37:24.050Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gromacs下蛋白-配体复合物模拟[GAFF]">
<meta name="twitter:description" content="gromacs小分子的配体的电荷问题一直时gromacs模拟蛋白-配体复合物中的难点与重点～网上有许多相关方面的教程，但是都没有成为系统，应李继存老师之邀，把最近摸索的方法过程总结出来，分享给大家～感谢网络上的朋友对我的帮助～ 我们以我现在在做的蛋白配体复合物进行模拟，蛋白质为AhR的PAS-B结构域，其是AhR转录因子的配体结合区～TCDD复合物是AhR的经典激动剂。 由于AhR晶体结构并未解析">
<meta name="twitter:image" content="http://kangsgo.com/images/2015/12/vmdscene.png">
    
        <link rel="alternate" type="application/atom+xml" title="小康博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">kangsgo</h5>
          <a href="mailto:kangsgo@vip.qq.com" title="kangsgo@vip.qq.com" class="mail">kangsgo@vip.qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/kangsgo" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.aspirincode.com/"  >
                <i class="icon icon-lg icon-link"></i>
                AspirinCode
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">gromacs下蛋白-配体复合物模拟[GAFF]</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">gromacs下蛋白-配体复合物模拟[GAFF]</h1>
        <h5 class="subtitle">
            
                <time datetime="2015-12-05T08:10:06.000Z" itemprop="datePublished" class="page-time">
  2015-12-05
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子模拟/">分子模拟</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
<article id="post-gromacs下蛋白-配体复合物模拟[GAFF]"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">gromacs下蛋白-配体复合物模拟[GAFF]</h1>
        <div class="post-meta">
            <time class="post-time" title="2015-12-05 16:10:06" datetime="2015-12-05T08:10:06.000Z"  itemprop="datePublished">2015-12-05</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子模拟/">分子模拟</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>gromacs小分子的配体的电荷问题一直时gromacs模拟蛋白-配体复合物中的难点与重点～网上有许多相关方面的教程，但是都没有成为系统，应李继存老师之邀，把最近摸索的方法过程总结出来，分享给大家～感谢网络上的朋友对我的帮助～</p>
<p>我们以我现在在做的蛋白配体复合物进行模拟，蛋白质为AhR的PAS-B结构域，其是AhR转录因子的配体结合区～TCDD复合物是AhR的经典激动剂。</p>
<p>由于AhR晶体结构并未解析，建模的方法我在这里不累述</p>
<p>你可以在这里下载初始文件:<a href="/images/2015/12/tcddPhe289Ala.tar.gz">tcddPhe289Ala.tar</a></p>
<p><span style="color: #ff0000;">mdp文件建议从压缩包中的进行修改，以免直接复制导致换行问题。</span></p>
<a id="more"></a>
<p>1.高斯输入文件建立</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">antechamber -i tcdd-h.mol2 -<span class="keyword">fi</span> mol2 -o tcdd.gjf -fo gcrt -pf y -gm <span class="string">"%mem=1024MB"</span> -gn <span class="string">"%nproc=2"</span> -nc 0 -gk <span class="string">"#HF/6-31G*SCF=tight Test Pop=MK iop(6/33=2) iop(6/42=6) iop(6/50=1) opt nosymm"</span> -ge tcdd_resp.gesp -gv 1</div></pre></td></tr></table></figure>
<p>其中nosymm是是否保留坐标，可以不加。高斯windows版本内存最多使用1G</p>
<p>2.运行高斯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">g09 tcdd.gjf</div></pre></td></tr></table></figure>
<p>3.拟合成resp文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">antechamber -i tcdd_resp.gesp -<span class="keyword">fi</span> gesp -o tcdd.mol2 -fo mol2 -pf y -c resp -rn TCD</div></pre></td></tr></table></figure>
<p>4.生成缺失参数文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">parmchk2 -i tcdd.mol2 -f mol2 -o tcdd.frcmod</div></pre></td></tr></table></figure>
<p>5.生成AMBER参数文件及坐标文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">source leaprc.ff99SB</div><div class="line"> source leaprc.gaff</div><div class="line"> loadamberparams tcdd.frcmod</div><div class="line"> lig=loadmol2 tcdd.mol2</div><div class="line"> check lig</div><div class="line"> saveamberparm lig tcdd.prmtop tcdd.inpcrd</div><div class="line"> quit</div></pre></td></tr></table></figure>
<p>命名为<code>leap.in</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tleap -f leap.in</div></pre></td></tr></table></figure>
<p>6.将AMBER文件转换为GROMACS文件</p>
<p>这里有两种办法amb2gmx.pl和acpype.py，一般使用后者</p>
<p>命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python2.7 acpype -p tcdd.prmtop -x tcdd.inpcrd -d</div></pre></td></tr></table></figure>
<p>将会得到MOL_GMX.gro和MOL_GMX.top两个文件为下面做准备</p>
<p>7.准备蛋白质的拓扑</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx pdb2gmx -f mAhR.pdb -o mAhR_processed.gro -water tip3p</div></pre></td></tr></table></figure>
<p>注：群里说tip3p准确度比spec高</p>
<blockquote>
<p>力场选择amber99SB 5</p>
</blockquote>
<p>8.准备小分子拓扑结构</p>
<p>将得到的TCD_GMX.top中顶部的[defaults]，[ atomtypes ]，底部的[ system ]，[ molecules ]删除，改名为TCD.itp</p>
<p>复制mAhR_processed.gro，重命名为complex.gro 将TCD_GMX.gro中内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">1  TCD  CL1    1   1.163  -4.344   0.912</div><div class="line">1  TCD  CL2    2   1.223  -4.088   0.726</div><div class="line">1  TCD  CL3    3   2.103  -4.309   1.263</div><div class="line">1  TCD  CL4    4   2.164  -4.054   1.077</div><div class="line">1  TCD   O1    5   1.637  -4.310   1.076</div><div class="line">1  TCD   O2    6   1.690  -4.088   0.913</div><div class="line">1  TCD   C1    7   1.542  -4.258   0.994</div><div class="line">1  TCD   C2    8   1.568  -4.148   0.914</div><div class="line">1  TCD   C3    9   1.759  -4.250   1.075</div><div class="line">1  TCD   C4   10   1.785  -4.140   0.995</div><div class="line">1  TCD   C5   11   1.417  -4.317   0.992</div><div class="line">1  TCD   C6   12   1.469  -4.098   0.832</div><div class="line">1  TCD   C7   13   1.857  -4.300   1.157</div><div class="line">1  TCD   C8   14   1.909  -4.081   0.997</div><div class="line">1  TCD   C9   15   1.318  -4.266   0.911</div><div class="line">1  TCD  C10   16   1.344  -4.156   0.830</div><div class="line">1  TCD  C11   17   1.983  -4.242   1.159</div><div class="line">1  TCD  C12   18   2.009  -4.132   1.079</div><div class="line">1  TCD   H1   19   1.399  -4.402   1.055</div><div class="line">1  TCD   H2   20   1.490  -4.013   0.771</div><div class="line">1  TCD   H3   21   1.836  -4.385   1.218</div><div class="line">1  TCD   H4   22   1.928  -3.996   0.934</div></pre></td></tr></table></figure>
<p>添加到complex.gro底部数字行上面将顶部1741加22个原子改为1763，保存。</p>
<p>在topol文件中添加小分子的位置限制：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">; Include Position restraint file</div><div class="line">#ifdef POSRES</div><div class="line">#include &quot;posre.itp&quot;</div><div class="line">#endif</div><div class="line"></div><div class="line">; Include ligand topology </div><div class="line">#include &quot;TCD.itp&quot; </div><div class="line"></div><div class="line">; Include water topology</div><div class="line">#include &quot;amber99sb.ff/tip3p.itp&quot;</div><div class="line"></div><div class="line">[ molecules ]</div><div class="line">; Compound        #mols</div><div class="line">Protein             1</div><div class="line">TCD                 1</div></pre></td></tr></table></figure>
<p>[注：增加了itp文件，以及molecules增加了小分子，即：]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">; Include ligand topology </div><div class="line">#include &quot;TCD.itp&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TCD                 1</div></pre></td></tr></table></figure>
<p>9.定义单元盒子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx editconf -f complex.gro -o newbox.gro -bt cubic -d 1.2</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx solvate -cp newbox.gro -cs spc216.gro -p topol.top -o solv.gro</div></pre></td></tr></table></figure>
<p>用vmd观察蛋白体系是否在盒子内部</p>
<p><img src="/images/2015/12/vmdscene.png" alt="vmdscene"></p>
<p>个人感觉盒子可以调小一些～</p>
<p>10.添加离子</p>
<p>教程使用了能量最小化的文件，我这里稍微改了一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">; LINES STARTING WITH &apos;;&apos; ARE COMMENTS</div><div class="line">title       = Minimization  ; 标题</div><div class="line">define          = -DFLEXIBLE   ;使用柔性水模型而非刚性模型, 这样最陡下降法可进一步最小化能量</div><div class="line"></div><div class="line">; Parameters describing what to do, when to stop and what to save</div><div class="line">; 参数描述如何做，当模拟结束后如何保存</div><div class="line">integrator  = steep     ; Algorithm (steep = steepest descent minimization) 最陡梯度法</div><div class="line">emtol       = 1000.0    ; Stop minimization when the maximum force &lt; 10.0 kJ/mol    当小于多少能量以后停止最小化</div><div class="line">emstep      = 0.01      ; Energy step size  能量步大小</div><div class="line">nsteps      = 50000     ; Maximum number of (minimization) steps to perform  最大最小化步骤</div><div class="line">energygrps  = system    ; Which energy group(s) to write to disk   哪个组进行能量最小化</div><div class="line"></div><div class="line">; Parameters describing how to find the neighbors of each atom and how to calculate the interactions</div><div class="line">; 参数描述怎样寻找邻近的原子，怎么样计算相互联系</div><div class="line">nstlist         = 1         ; Frequency to update the neighbor list and long range forces 更新近邻列表的频率. 1表示每步都更新</div><div class="line">cutoff-scheme   = Verlet           ; With cutoff-scheme=Verlet and verlet-buffer-tolerance set, nstlist is actually a minimum value and mdrun might increase it, unless it is set to 1 这样设置更加精确（看英文貌似是的）</div><div class="line">ns_type         = grid      ; Method to determine neighbor list (simple, grid)</div><div class="line">rlist           = 1.0       ; Cut-off for making neighbor list (short range forces) 短程力近邻列表的截断值</div><div class="line">coulombtype     = PME       ; Treatment of long range electrostatic interactions 计算长程静电的方法. PME为粒子网格Ewald方法, 还可以使用cut-off</div><div class="line">rcoulomb        = 1.0       ; long range electrostatic cut-off   长程库仑力截断值</div><div class="line">rvdw            = 1.0       ; long range Van der Waals cut-off  范德华距离截断值</div><div class="line">constraints         = none             ;无位置限制</div><div class="line">pbc             = xyz       ; Periodic Boundary Conditions  周期性</div></pre></td></tr></table></figure>
<p>我们这里还需要查看topol文件，看一下我们的体系电荷多少，需要补足电荷，可以看出我们需要补4个CL离子</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/topol.png" alt="topol" title="">
                </div>
                <div class="image-caption">topol</div>
            </figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx grompp -f em.mdp -c solv.gro -p topol.top -o ions.tpr</div></pre></td></tr></table></figure>
<p>做到这里会报错，我找了很久原因，后来查看amber力场文件，发现是大小写不同导致的<br>我们来看一下我们的TCD.itp文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"> 1   Cl     1   TCD   CL1    1    -0.072622     35.45000 ; qtot -0.073</div><div class="line"> 2   Cl     1   TCD   CL2    2    -0.072622     35.45000 ; qtot -0.145</div><div class="line"> 3   Cl     1   TCD   CL3    3    -0.072622     35.45000 ; qtot -0.218</div><div class="line"> 4   Cl     1   TCD   CL4    4    -0.072622     35.45000 ; qtot -0.290</div><div class="line"> 5   OS     1   TCD    O1    5    -0.320484     16.00000 ; qtot -0.611</div><div class="line"> 6   OS     1   TCD    O2    6    -0.320484     16.00000 ; qtot -0.931</div><div class="line"> 7   CA     1   TCD    C1    7     0.247670     12.01000 ; qtot -0.684</div><div class="line"> 8   CA     1   TCD    C2    8     0.247670     12.01000 ; qtot -0.436</div><div class="line"> 9   CA     1   TCD    C3    9     0.247670     12.01000 ; qtot -0.188</div><div class="line">10   CA     1   TCD    C4   10     0.247670     12.01000 ; qtot 0.059</div><div class="line">11   CA     1   TCD    C5   11    -0.253268     12.01000 ; qtot -0.194</div><div class="line">12   CA     1   TCD    C6   12    -0.253268     12.01000 ; qtot -0.447</div><div class="line">13   CA     1   TCD    C7   13    -0.253268     12.01000 ; qtot -0.701</div><div class="line">14   CA     1   TCD    C8   14    -0.253268     12.01000 ; qtot -0.954</div><div class="line">15   CA     1   TCD    C9   15     0.041544     12.01000 ; qtot -0.912</div><div class="line">16   CA     1   TCD   C10   16     0.041544     12.01000 ; qtot -0.871</div><div class="line">17   CA     1   TCD   C11   17     0.041544     12.01000 ; qtot -0.829</div><div class="line">18   CA     1   TCD   C12   18     0.041544     12.01000 ; qtot -0.788</div><div class="line">19   HA     1   TCD    H1   19     0.196918      1.00800 ; qtot -0.591</div><div class="line">20   HA     1   TCD    H2   20     0.196918      1.00800 ; qtot -0.394</div><div class="line">21   HA     1   TCD    H3   21     0.196918      1.00800 ; qtot -0.197</div><div class="line">22   HA     1   TCD    H4   22     0.196918      1.00800 ; qtot -0.000</div></pre></td></tr></table></figure>
<p>然而amber99SB力场下如是写的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Cl          17      35.45    0.0000  A   4.40104e-01  4.18400e-01</div></pre></td></tr></table></figure>
<p><span style="color: #ff0000;">我们需要将top文件的[ atomtypes ]可以写入相应力场的ffnonbonded.itp中，这个方法更加的实用。</span></p>
<p>个人认为比较稳妥且不会污染力场的方法为将力场文件复制出来，然后在当前目录中进行修改，如果采用apt-get安装，可以在usr/share/gromacs/top下查找对应力场文件,例如拷贝amber99sb-ildn-ligand.ff力场文件，重命名为amber99sb-ildn-ligand.ff，将; Include forcefield parameters下面一行修改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#include &quot;amber99sb-ildn-ligand.ff/forcefield.itp&quot;</div></pre></td></tr></table></figure>
<p>topol文件其它引用力场的位置可修改可不修改，个人觉得最好修改</p>
<p><img src="/images/2015/12/2.png" alt="2"></p>
<p>然后就是添加离子了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx genion -s ions.tpr -o solv_ions.gro -p topol.top -pname NA -nname CL -nn 4</div></pre></td></tr></table></figure>
<p>-nn 表示的添加阴离子数目</p>
<blockquote>
<p>选择15，添加在水溶剂里面</p>
</blockquote>
<p>会有如下话：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Back Off! I just backed up topol.top to ./#topol.top.2#</div><div class="line">Replacing solvent molecule 1173 (atom 5282) with CL</div><div class="line">Replacing solvent molecule 3252 (atom 11519) with CL</div><div class="line">Replacing solvent molecule 2563 (atom 9452) with CL</div><div class="line">Replacing solvent molecule 10648 (atom 33707) with CL</div></pre></td></tr></table></figure>
<p>表示插入进去了</p>
<p>11.能量最小化</p>
<p>参数文件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">; LINES STARTING WITH &apos;;&apos; ARE COMMENTS</div><div class="line">title       = Minimization  ; Title of run</div><div class="line">define          = -DFLEXIBLE</div><div class="line"></div><div class="line">; Parameters describing what to do, when to stop and what to save</div><div class="line">integrator  = steep     ; Algorithm (steep = steepest descent minimization)</div><div class="line">emtol       = 500.0     ; Stop minimization when the maximum force &lt; 5.0 kJ/mol</div><div class="line">emstep      = 0.01      ; Energy step size</div><div class="line">nsteps      = 50000     ; Maximum number of (minimization) steps to perform</div><div class="line">energygrps  = Protein TCD   ; Which energy group(s) to write to disk</div><div class="line"></div><div class="line">; Parameters describing how to find the neighbors of each atom and how to calculate the interactions</div><div class="line">nstlist         = 1         ; Frequency to update the neighbor list and long range forces</div><div class="line">cutoff-scheme   = Verlet</div><div class="line">ns_type         = grid      ; Method to determine neighbor list (simple, grid)</div><div class="line">rlist           = 1.0       ; Cut-off for making neighbor list (short range forces)</div><div class="line">coulombtype     = PME       ; Treatment of long range electrostatic interactions</div><div class="line">rcoulomb        = 1.0       ; long range electrostatic cut-off</div><div class="line">rvdw            = 1.0       ; long range Van der Waals cut-off</div><div class="line">constraints         = none</div><div class="line">pbc             = xyz       ; Periodic Boundary Conditions</div></pre></td></tr></table></figure>
<p><strong><span style="color: #ff0000;">能量组为energygrps = Protein TCD，这里TCD需要根据自己的体系进行修改，下同 </span></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">energygrps   = Protein TCD</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx grompp -f em_real.mdp -c solv_ions.gro -p topol.top -o em.tpr</div></pre></td></tr></table></figure>
<p>运行模拟</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx mdrun -v -deffnm em</div></pre></td></tr></table></figure>
<p>个人认为在运行模拟之前要搞懂参数的意义，所幸这里有<a href="http://jerkwin.github.io/GMX/GMXprg#gmxmdrun:执行模拟简正分析或能量最小化翻译:王浩博" target="_blank" rel="external">中文参考教程</a>，因为要去吃饭了～这里就使用默认的先</p>
<p>我们发现700步就收敛了，所以我决定改成emtol= 1000修改成500再跑<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">1888步收敛了～所以我尝试删掉emtol= 1000</div><div class="line">但是通过前面的教程，其也是500来步就已经收敛了～</div><div class="line"></div><div class="line">结果如图</div><div class="line"></div><div class="line">PS：作图方法如下：</div><div class="line"></div><div class="line">```bash</div><div class="line">gmx energy -f em.edr -o potential.xvg</div></pre></td></tr></table></figure></p>
<p>选择 10 0</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/potential.png" alt="potential" title="">
                </div>
                <div class="image-caption">potential</div>
            </figure>
<p>再用共轭梯度法，mdp文件参数如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">; LINES STARTING WITH &apos;;&apos; ARE COMMENTS</div><div class="line">title       = Minimization  ; Title of run</div><div class="line">define          = -DFLEXIBLE</div><div class="line"></div><div class="line">; Parameters describing what to do, when to stop and what to save</div><div class="line">integrator  = cg        ; Algorithm (steep = steepest descent minimization)</div><div class="line">emtol       = 100.0     ; Stop minimization when the maximum force &lt; 10.0 kJ/mol</div><div class="line">emstep      = 0.01      ; Energy step size</div><div class="line">nsteps      = 50000     ; Maximum number of (minimization) steps to perform</div><div class="line">nstcgsteep      = 1000</div><div class="line">energygrps  = Protein TCD   ; Which energy group(s) to write to disk</div><div class="line"></div><div class="line">; Parameters describing how to find the neighbors of each atom and how to calculate the interactions</div><div class="line">nstlist         = 1         ; Frequency to update the neighbor list and long range forces</div><div class="line">cutoff-scheme   = Verlet</div><div class="line">ns_type         = grid      ; Method to determine neighbor list (simple, grid)</div><div class="line">rlist           = 1.0       ; Cut-off for making neighbor list (short range forces)</div><div class="line">coulombtype     = PME       ; Treatment of long range electrostatic interactions</div><div class="line">rcoulomb        = 1.0       ; long range electrostatic cut-off</div><div class="line">rvdw            = 1.0       ; long range Van der Waals cut-off</div><div class="line">constraints         = none</div><div class="line">pbc             = xyz       ; Periodic Boundary Conditions</div></pre></td></tr></table></figure>
<p>&nbsp;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx grompp -f em2.mdp -c em.gro -p topol.top -o em2.tpr</div></pre></td></tr></table></figure>
<p>运行模拟</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx mdrun -v -deffnm em2</div></pre></td></tr></table></figure>
<p>做出来如这个图，图是否正确待考</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/potential2.png" alt="potential2" title="">
                </div>
                <div class="image-caption">potential2</div>
            </figure>
<p>&nbsp;</p>
<p>12.NVT平衡（温度平衡）</p>
<p>限制配体：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx genrestr -f TCD.gro -o posre_TCD.itp -fc 1000 1000 1000</div></pre></td></tr></table></figure>
<p>在选择组过程中个人觉得选择system或者TCD均可<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/3.png" alt="3" title="">
                </div>
                <div class="image-caption">3</div>
            </figure></p>
<p>增加配体限制：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">; Include ligand topology</div><div class="line"><span class="comment">#include "TCD.itp"</span></div><div class="line"></div><div class="line"></div><div class="line">; Ligand position restraints </div><div class="line"><span class="comment">#ifdef POSRES </span></div><div class="line"><span class="comment">#include "posre_TCD.itp" </span></div><div class="line"><span class="comment">#endif</span></div><div class="line"></div><div class="line">; Include water topology</div><div class="line"><span class="comment">#include "amber99sb.ff/tip3p.itp"</span></div></pre></td></tr></table></figure>
<p>[注：插入的为]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">; Ligand position restraints </div><div class="line">#ifdef POSRES </div><div class="line">#include &quot;posre_TCD.itp&quot; </div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>其实这里还可以分开限制（具体这里还是没有特别理解～待我看一下参考资料）</p>
<p>热浴</p>
<p>–温度耦合需要蛋白质和配体在一起？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx make_ndx -f em2.gro -o index.ndx</div></pre></td></tr></table></figure>
<p>选择蛋白和配体分为一组</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/4.png" alt="4" title="">
                </div>
                <div class="image-caption">4</div>
            </figure>
<p>然后就可以热浴了～热浴的mdp如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">title       = Protein-ligand complex NVT equilibration </div><div class="line">define      = -DPOSRES  ; position restrain the protein and ligand</div><div class="line">; Run parameters</div><div class="line">integrator  = md        ; leap-frog integrator</div><div class="line">nsteps      = 50000     ; 2 * 50000 = 100 ps</div><div class="line">dt          = 0.002     ; 2 fs</div><div class="line">; Output control</div><div class="line">nstxout     = 200       ; save coordinates every 1.0 ps</div><div class="line">nstvout     = 200       ; save velocities every 1.0 ps</div><div class="line">nstenergy   = 200       ; save energies every 1.0 ps</div><div class="line">nstlog      = 200       ; update log file every 1.0 ps</div><div class="line">energygrps  = Protein TCD</div><div class="line">; Bond parameters</div><div class="line">continuation    = no            ; first dynamics run</div><div class="line">constraint_algorithm = lincs    ; holonomic constraints </div><div class="line">constraints     = all-bonds     ; all bonds (even heavy atom-H bonds) constrained</div><div class="line">lincs_iter      = 1             ; accuracy of LINCS</div><div class="line">lincs_order     = 4             ; also related to accuracy</div><div class="line">; Neighborsearching</div><div class="line">cutoff-scheme   = Verlet</div><div class="line">ns_type         = grid      ; search neighboring grid cells</div><div class="line">nstlist         = 10        ; 20 fs, largely irrelevant with Verlet</div><div class="line">rcoulomb        = 1.4       ; short-range electrostatic cutoff (in nm)</div><div class="line">rvdw            = 1.4       ; short-range van der Waals cutoff (in nm)</div><div class="line">; Electrostatics</div><div class="line">coulombtype     = PME       ; Particle Mesh Ewald for long-range electrostatics</div><div class="line">pme_order       = 4         ; cubic interpolation</div><div class="line">fourierspacing  = 0.16      ; grid spacing for FFT</div><div class="line">; Temperature coupling</div><div class="line">tcoupl      = V-rescale                     ; modified Berendsen thermostat</div><div class="line">tc-grps     = Protein_TCD Water_and_ions    ; two coupling groups - more accurate</div><div class="line">tau_t       = 0.1   0.1                     ; time constant, in ps</div><div class="line">ref_t       = 300   300                     ; reference temperature, one for each group, in K</div><div class="line">; Pressure coupling</div><div class="line">pcoupl      = no        ; no pressure coupling in NVT</div><div class="line">; Periodic boundary conditions</div><div class="line">pbc         = xyz       ; 3-D PBC</div><div class="line">; Dispersion correction</div><div class="line">DispCorr    = EnerPres  ; account for cut-off vdW scheme</div><div class="line">; Velocity generation</div><div class="line">gen_vel     = yes       ; assign velocities from Maxwell distribution</div><div class="line">gen_temp    = 300       ; temperature for Maxwell distribution</div><div class="line">gen_seed    = -1        ; generate a random seed</div></pre></td></tr></table></figure>
<p>&nbsp;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gmx grompp -f nvt.mdp -c em2.gro -p topol.top -n index.ndx -o nvt.tpr</div><div class="line">gmx mdrun -deffnm nvt</div></pre></td></tr></table></figure>
<p>完成后我的析出如图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">NOTE: The GPU has &gt;20% more load than the CPU. This imbalance causes</div><div class="line">      performance loss, consider using a shorter cut-off and a finer PME grid.</div><div class="line"></div><div class="line">               Core t (s)   Wall t (s)        (%)</div><div class="line">       Time:     3799.500      518.255      733.1</div><div class="line">                 (ns/day)    (hour/ns)</div><div class="line">Performance:       16.672        1.440</div></pre></td></tr></table></figure>
<p>可以看出我的GPU太渣，暂时没有想到解决办法</p>
<p>我们来看一下NVT耦合的怎么样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx energy -f nvt.edr -o template.xvg</div></pre></td></tr></table></figure>
<p>选择15 0</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/template.png" alt="template" title="">
                </div>
                <div class="image-caption">template</div>
            </figure>
<p>13.NPT平衡<br>mdp文件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">title       = Protein-ligand complex NPT equilibration </div><div class="line">define      = -DPOSRES  ; position restrain the protein and ligand</div><div class="line">; Run parameters</div><div class="line">integrator  = md        ; leap-frog integrator</div><div class="line">nsteps      = 50000     ; 2 * 50000 = 100 ps</div><div class="line">dt          = 0.002     ; 2 fs</div><div class="line">; Output control</div><div class="line">nstxout     = 200       ; save coordinates every 1.0 ps</div><div class="line">nstvout     = 200       ; save velocities every 1.0 ps</div><div class="line">nstenergy   = 200       ; save energies every 1.0 ps</div><div class="line">nstlog      = 200       ; update log file every 1.0 ps</div><div class="line">energygrps  = Protein TCD</div><div class="line">; Bond parameters</div><div class="line">continuation    = yes           ; first dynamics run</div><div class="line">constraint_algorithm = lincs    ; holonomic constraints </div><div class="line">constraints     = all-bonds     ; all bonds (even heavy atom-H bonds) constrained</div><div class="line">lincs_iter      = 1             ; accuracy of LINCS</div><div class="line">lincs_order     = 4             ; also related to accuracy</div><div class="line">; Neighborsearching</div><div class="line">cutoff-scheme   = Verlet</div><div class="line">ns_type         = grid      ; search neighboring grid cells</div><div class="line">nstlist         = 10        ; 20 fs, largely irrelevant with Verlet</div><div class="line">rcoulomb        = 1.4       ; short-range electrostatic cutoff (in nm)</div><div class="line">rvdw            = 1.4       ; short-range van der Waals cutoff (in nm)</div><div class="line">; Electrostatics</div><div class="line">coulombtype     = PME       ; Particle Mesh Ewald for long-range electrostatics</div><div class="line">pme_order       = 4         ; cubic interpolation</div><div class="line">fourierspacing  = 0.16      ; grid spacing for FFT</div><div class="line">; Temperature coupling</div><div class="line">tcoupl      = V-rescale                     ; modified Berendsen thermostat</div><div class="line">tc-grps     = Protein_TCD Water_and_ions    ; two coupling groups - more accurate</div><div class="line">tau_t       = 0.1   0.1                     ; time constant, in ps</div><div class="line">ref_t       = 300   300                     ; reference temperature, one for each group, in K</div><div class="line">; Pressure coupling</div><div class="line">pcoupl      = Parrinello-Rahman             ; pressure coupling is on for NPT</div><div class="line">pcoupltype  = isotropic                     ; uniform scaling of box vectors</div><div class="line">tau_p       = 2.0                           ; time constant, in ps</div><div class="line">ref_p       = 1.0                           ; reference pressure, in bar</div><div class="line">compressibility = 4.5e-5                    ; isothermal compressibility of water, bar^-1</div><div class="line">refcoord_scaling    = com</div><div class="line">; Periodic boundary conditions</div><div class="line">pbc         = xyz       ; 3-D PBC</div><div class="line">; Dispersion correction</div><div class="line">DispCorr    = EnerPres  ; account for cut-off vdW scheme</div><div class="line">; Velocity generation</div><div class="line">gen_vel     = no        ; velocity generation off after NVT</div></pre></td></tr></table></figure>
<p><span style="color: #ff0000;">注意，耦合组为Protein_TCD，自己的体系需要修改成自己的，下同</span></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gmx grompp -f npt.mdp -c nvt.gro -t nvt.cpt -p topol.top -n index.ndx -o npt.tpr</div><div class="line"></div><div class="line">gmx mdrun -deffnm npt</div></pre></td></tr></table></figure>
<p>先看一下压力</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx energy -f npt.edr -o pressure.xvg</div></pre></td></tr></table></figure>
<p>选择 16 0</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/pressure.png" alt="pressure" title="">
                </div>
                <div class="image-caption">pressure</div>
            </figure>
<p>再来看一下密度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx energy -f npt.edr -o density.xvg</div></pre></td></tr></table></figure>
<p>选择 22 0</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/density.png" alt="density" title="">
                </div>
                <div class="image-caption">density</div>
            </figure>
<p>可以看出在1000左右，符合水的密度，个人觉得tip3p效果比spec水模型效果好</p>
<p>14.成品MD</p>
<p>一般MD需要100ns以上，但是我的电脑我怕受不了，就先50ns吧～大约需要3天-4天左右</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">title       = Protein-ligand complex MD simulation </div><div class="line">; Run parameters</div><div class="line">integrator  = md        ; leap-frog integrator</div><div class="line">nsteps      = 25000000    ; 2 * 25000000 = 50000 ps (50 ns)</div><div class="line">dt          = 0.002     ; 2 fs</div><div class="line">; Output control</div><div class="line">nstxout             = 0         ; suppress .trr output </div><div class="line">nstvout             = 0         ; suppress .trr output</div><div class="line">nstenergy           = 5000      ; save energies every 10.0 ps</div><div class="line">nstlog              = 5000      ; update log file every 10.0 ps</div><div class="line">nstxout-compressed  = 5000      ; write .xtc trajectory every 10.0 ps</div><div class="line">compressed-x-grps   = System</div><div class="line">energygrps          = Protein TCD</div><div class="line">; Bond parameters</div><div class="line">continuation    = yes           ; first dynamics run</div><div class="line">constraint_algorithm = lincs    ; holonomic constraints </div><div class="line">constraints     = all-bonds     ; all bonds (even heavy atom-H bonds) constrained</div><div class="line">lincs_iter      = 1             ; accuracy of LINCS</div><div class="line">lincs_order     = 4             ; also related to accuracy</div><div class="line">; Neighborsearching</div><div class="line">cutoff-scheme   = Verlet</div><div class="line">ns_type         = grid      ; search neighboring grid cells</div><div class="line">nstlist         = 10        ; 20 fs, largely irrelevant with Verlet</div><div class="line">rcoulomb        = 1.4       ; short-range electrostatic cutoff (in nm)</div><div class="line">rvdw            = 1.4       ; short-range van der Waals cutoff (in nm)</div><div class="line">; Electrostatics</div><div class="line">coulombtype     = PME       ; Particle Mesh Ewald for long-range electrostatics</div><div class="line">pme_order       = 4         ; cubic interpolation</div><div class="line">fourierspacing  = 0.16      ; grid spacing for FFT</div><div class="line">; Temperature coupling</div><div class="line">tcoupl      = V-rescale                     ; modified Berendsen thermostat</div><div class="line">tc-grps     = Protein_TCD Water_and_ions    ; two coupling groups - more accurate</div><div class="line">tau_t       = 0.1   0.1                     ; time constant, in ps</div><div class="line">ref_t       = 300   300                     ; reference temperature, one for each group, in K</div><div class="line">; Pressure coupling </div><div class="line">pcoupl      = Parrinello-Rahman             ; pressure coupling is on for NPT</div><div class="line">pcoupltype  = isotropic                     ; uniform scaling of box vectors</div><div class="line">tau_p       = 2.0                           ; time constant, in ps</div><div class="line">ref_p       = 1.0                           ; reference pressure, in bar</div><div class="line">compressibility = 4.5e-5                    ; isothermal compressibility of water, bar^-1</div><div class="line">; Periodic boundary conditions</div><div class="line">pbc         = xyz       ; 3-D PBC</div><div class="line">; Dispersion correction</div><div class="line">DispCorr    = EnerPres  ; account for cut-off vdW scheme</div><div class="line">; Velocity generation</div><div class="line">gen_vel     = no        ; assign velocities from Maxwell distribution</div></pre></td></tr></table></figure>
<p><span style="color: #ff0000;">注意：nsteps = 25000000 ; 2 * 25000000 = 50000 ps (50 ns) 这里修改时长，同时注意修改耦合组成为自己的</span></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gmx grompp -f md.mdp -c npt.gro -t npt.cpt -p topol.top -n index.ndx -o md_0_1.tpr</div><div class="line">gmx mdrun -deffnm md_0_1</div></pre></td></tr></table></figure>
<p>经过2d12h的计算，终于完成了，即高兴又紧张。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2015/12/5.png" alt="5" title="">
                </div>
                <div class="image-caption">5</div>
            </figure>
<p>由于这个贴实在太长，另外开一贴</p>
<p>参考文献：<a href="http://platinhom.github.io/2015/09/17/AutoCalcRESP/" target="_blank" rel="external">自动计算ESP和RESP电荷(AMBER and G09)</a></p>
<p>参考文献：<a href="http://bioms.org/forum.php?mod=viewthread&amp;tid=409&amp;highlight=GAFF" target="_blank" rel="external">小分子在GAFF立场GROMCA中的操作</a></p>
<p>参考文献：<a href="http://jerkwin.github.io/2015/12/08/%E4%BD%BF%E7%94%A8AmberTools+ACPYPE+Gaussian%E5%88%9B%E5%BB%BA%E5%B0%8F%E5%88%86%E5%AD%90GAFF%E5%8A%9B%E5%9C%BA%E7%9A%84%E6%8B%93%E6%89%91%E6%96%87%E4%BB%B6/" target="_blank" rel="external">使用AmberTools+ACPYPE+Gaussian创建小分子GAFF力场的拓扑文件</a></p>
<p>参考文献：<a href="http://jerkwin.github.io/GMX/GMXtut-5#TOC2" target="_blank" rel="external">蛋白质配体复合物</a></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-12-21T11:37:24.050Z" itemprop="dateUpdated">2017-12-21 19:37:24</time>
</span><br>


        
        链接：<a href="/94.html" target="_blank" rel="external">http://kangsgo.com/94.html</a>
        
    </div>
    <footer>
        <a href="http://kangsgo.com">
            <img src="/img/avatar.jpg" alt="kangsgo">
            kangsgo
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Gromacs/">Gromacs</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/94.html&title=《gromacs下蛋白-配体复合物模拟[GAFF]》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/94.html&title=《gromacs下蛋白-配体复合物模拟[GAFF]》 — 小康博客&source=gromacs小分子的配体的电荷问题一直时gromacs模拟蛋白-配体复合物中的难点与重点～网上有许多相关方面的教程，但是都没有成为系统，应李继存老师之邀..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/94.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《gromacs下蛋白-配体复合物模拟[GAFF]》 — 小康博客&url=http://kangsgo.com/94.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/94.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/106.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Gromacs共轭梯度法mdp设置</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/89.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Autodock与AutoDock vina利用pymol插件使用教程</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>kangsgo &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/94.html&title=《gromacs下蛋白-配体复合物模拟[GAFF]》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/94.html&title=《gromacs下蛋白-配体复合物模拟[GAFF]》 — 小康博客&source=gromacs小分子的配体的电荷问题一直时gromacs模拟蛋白-配体复合物中的难点与重点～网上有许多相关方面的教程，但是都没有成为系统，应李继存老师之邀..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/94.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《gromacs下蛋白-配体复合物模拟[GAFF]》 — 小康博客&url=http://kangsgo.com/94.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/94.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAAAAAAZai4+AAABVElEQVR42u3a0Q7DIAiF4b7/S3cPYCTngGSp/Fwt66Zfl2iZ8DxyvEusV9dPrlcPByxYF7HeMHaT7UC78fW5YMGazFKGU9Zy/F1lLliwYFUWf7wFwIIFq4MVbwF/2yBgwfo4K7ew3astuTwsWFew9FOd+uuW8y1YsD7Oes1wubmABWsaS1/A8ZGunkAb48OCNYZVP6itFD6348OCNYyVOzbS2xEOpNSwYA1guZPFqXM9gYYFazLLfdzmNgtjx4IFaxjLbSCobwrJbAIWrAEs/aCno7Zj/EKwYA1gxcc9yvahPKT192HBmsnKdQLoZRi9JQgWrGmsSsOB/sC2bwYWrGEsN7XtQJcCFqyLWMpkbrrstiZIJRZYsAaw3BaEswELFqwcSymrlG4VFixY5p/SXGkz2YoHC9bVLD3xVb6rV0mMmg8sWFezcm0BblGzJe2GBesG1g8ywe42OMO5vAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
