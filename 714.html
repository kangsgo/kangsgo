<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>Pymol小脚本之Rotkit | 小康博客 | 计算化学与分子模拟爱好者</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="Rotkit是一个pymol小脚本工具包，依稀记得还是大四的时候有人在bioms群里出售一个脚本，可以将配体周围的氨基酸残基进行突变，然后进行突变对接或者分析，来简单的查看突变对配体与蛋白之间的相互影响。当时觉得非常的高达上，今天查看Pymol的时候发现这个小脚本就可以非常容易的实现这个功能，当然pymol的功能不仅仅如此，还有更多的功能。 这个脚本套件是一个小的脚本合集，能够精确的将小分子放在你">
<meta property="og:type" content="article">
<meta property="og:title" content="Pymol小脚本之Rotkit">
<meta property="og:url" content="http://kangsgo.com/714.html">
<meta property="og:site_name" content="小康博客">
<meta property="og:description" content="Rotkit是一个pymol小脚本工具包，依稀记得还是大四的时候有人在bioms群里出售一个脚本，可以将配体周围的氨基酸残基进行突变，然后进行突变对接或者分析，来简单的查看突变对配体与蛋白之间的相互影响。当时觉得非常的高达上，今天查看Pymol的时候发现这个小脚本就可以非常容易的实现这个功能，当然pymol的功能不仅仅如此，还有更多的功能。 这个脚本套件是一个小的脚本合集，能够精确的将小分子放在你">
<meta property="og:locale" content="zh">
<meta property="og:updated_time" content="2017-10-18T12:17:14.231Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pymol小脚本之Rotkit">
<meta name="twitter:description" content="Rotkit是一个pymol小脚本工具包，依稀记得还是大四的时候有人在bioms群里出售一个脚本，可以将配体周围的氨基酸残基进行突变，然后进行突变对接或者分析，来简单的查看突变对配体与蛋白之间的相互影响。当时觉得非常的高达上，今天查看Pymol的时候发现这个小脚本就可以非常容易的实现这个功能，当然pymol的功能不仅仅如此，还有更多的功能。 这个脚本套件是一个小的脚本合集，能够精确的将小分子放在你">
    
        <link rel="alternate" type="application/atom+xml" title="小康博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">kangsgo</h5>
          <a href="mailto:634206017@qq.com" title="634206017@qq.com" class="mail">634206017@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/yscoder" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/ysweb" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/custom"  >
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Pymol小脚本之Rotkit</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Pymol小脚本之Rotkit</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-09-05T12:25:21.000Z" itemprop="datePublished" class="page-time">
  2017-09-05
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/绘图与可视化/">绘图与可视化</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#PyMOL可用的脚本功能"><span class="post-toc-number">1.</span> <span class="post-toc-text">PyMOL可用的脚本功能</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#通过rotkit-functionname"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">通过rotkit.functionname</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#示例"><span class="post-toc-number"></span> <span class="post-toc-text">示例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#示例1-对结构进行旋转"><span class="post-toc-number">1.</span> <span class="post-toc-text">示例1-对结构进行旋转</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#示例2-模拟染料的自由度"><span class="post-toc-number">2.</span> <span class="post-toc-text">示例2-模拟染料的自由度</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#示例3-创建距离分布直方图"><span class="post-toc-number">3.</span> <span class="post-toc-text">示例3-创建距离分布直方图</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#示例5-功能向导文件"><span class="post-toc-number">4.</span> <span class="post-toc-text">示例5-功能向导文件</span></a></li></ol>
        </nav>
    </aside>
    
<article id="post-pymol-e5-b0-8f-e8-84-9a-e6-9c-ac-e4-b9-8brotkit"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Pymol小脚本之Rotkit</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-09-05 20:25:21" datetime="2017-09-05T12:25:21.000Z"  itemprop="datePublished">2017-09-05</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/绘图与可视化/">绘图与可视化</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>Rotkit是一个pymol小脚本工具包，依稀记得还是大四的时候有人在bioms群里出售一个脚本，可以将配体周围的氨基酸残基进行突变，然后进行突变对接或者分析，来简单的查看突变对配体与蛋白之间的相互影响。当时觉得非常的高达上，今天查看Pymol的时候发现这个小脚本就可以非常容易的实现这个功能，当然pymol的功能不仅仅如此，还有更多的功能。</p>
<p>这个脚本套件是一个小的脚本合集，能够精确的将小分子放在你想要的蛋白质上。（虽然官方介绍这么说，但是还是要强调一下功能远不止如此）</p>
<h3 id="PyMOL可用的脚本功能"><a href="#PyMOL可用的脚本功能" class="headerlink" title="PyMOL可用的脚本功能"></a>PyMOL可用的脚本功能</h3><pre class="EnlighterJSRAW" data-enlighter-language="python">rotateline(Pos1,Pos2,degangle,molecule):
     "Pos1&gt;Pos2"定义了一个“分子”将旋转“degangle”的度数
      rotateline Pos1=P513C_CA, Pos2=P513C_CB, degangle=5, molecule=Atto590
     rotateline Pos1=dyeatom87, Pos2=dyeatom85, degangle=10, molecule=Atto590

mutate(molecule,chain,resi,target="CYS",mutframe="1"):
    突变目标一个/分子/链/残基，并且选择最可能的帧
     mutate 1HP1, chain=A, resi=515, target=CYS, mutframe=1

toline(Pos1,Pos2,atom,molecule,dist=1):
    平移分子原子，1 埃的距离，方向为Pos1&gt;Pos2
    toline Pos1=P513C_CA, Pos2=P513C_CB, atom=dyeatom87, molecule=Atto590, dist=3</pre>

<h4 id="通过rotkit-functionname"><a href="#通过rotkit-functionname" class="headerlink" title="通过rotkit.functionname"></a>通过rotkit.functionname</h4><pre class="EnlighterJSRAW" data-enlighter-language="python">printMat(matrix):
    打印 TTT matrix 格式. (4X4)
getxyz(Sel):
    输出一个列表[x,y,z]，为浮点数
vector(Sel1,Sel2):
   寻找两个点的向量
vectorstr(vector):
   将vector的格式转换为str格式（开始为列表格式）
transmat(vector,dist=1):
   根据输入向量制作TTT转换矩阵。 矢量乘以距离。
unitvector(vector):
   将vector变为单位矢量
radangle(angle):
   转换角度变为弧度（radians）
rotmat(angle,vectornorm,pointcoord):
   围绕一个坐标点进行旋转
point.crossprod(Vector1, Vector2):
   两个向量进行矢量积
crosspoint(Pos1, crossprod):
Returns the endpoint for the Position plus the crossproduct vector. Suitable if one would like to rotate around a crossvector.</pre>

<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><h3 id="示例1-对结构进行旋转"><a href="#示例1-对结构进行旋转" class="headerlink" title="示例1-对结构进行旋转"></a>示例1-对结构进行旋转</h3><pre class="EnlighterJSRAW" data-enlighter-language="python">reinitialize
import rotkit

fetch 1HP1, async=0
show_as cartoon, 1HP1
show_as sticks, 1HP1 and resn ATP

###################### Make rotation axis #################
pseudoatom axisA, vdw=1.0
pseudoatom axisB, vdw=1.0
rotkit.toline("/1HP1//A/477/C","/1HP1//A/423/CG1","axisA","axisA",20)
rotkit.toline("/1HP1//A/423/CG1","/1HP1//A/477/C","axisB","axisB",5)
show spheres, axisA or axisB 
label axisA, "axisA" 
label axisB, "axisB" 
dist rotaxis, axisA, axisB
color green, rotaxis
set dash_width, 5
set dash_gap, 0
hide label, rotaxis

## Create rotate states of 1HP1
create 1HP1_rot, 1HP1, 1, 1
python
ang_incr = 1
anglerange = range(2,98,ang_incr)
nrstates = len(anglerange)+1
states = 1
for angle in anglerange:
  states += 1
  rot_1HP1 = "1HP1_rot_%s"%angle
  cmd.create(rot_1HP1,"(1HP1 and resi 363-550) or (1HP1 and resn ATP)")
  rotkit.rotateline("axisA","axisB",-(angle-1),rot_1HP1)    
  cmd.create("1HP1_rot",rot_1HP1,1,states)
  cmd.create("1HP1_rot",rot_1HP1,1,2*nrstates-states)
  cmd.delete(rot_1HP1)
python end
hide cartoon, (1HP1 and resi 363-550)
hide sticks, (1HP1 and resn ATP)
mplay</pre>

<h3 id="示例2-模拟染料的自由度"><a href="#示例2-模拟染料的自由度" class="headerlink" title="示例2-模拟染料的自由度"></a>示例2-模拟染料的自由度</h3><pre class="EnlighterJSRAW" data-enlighter-language="python">reinitialize
import rotkit

fetch 1HP1, async=0
show_as cartoon, 1HP1
show_as sticks, 1HP1 and resn ATP
set auto_zoom, off

###################### Make rotation axis #################
pseudoatom axisA, vdw=1.0
pseudoatom axisB, vdw=1.0
rotkit.toline("/1HP1//A/477/C","/1HP1//A/423/CG1","axisA","axisA",20)
rotkit.toline("/1HP1//A/423/CG1","/1HP1//A/477/C","axisB","axisB",5)
show spheres, axisA or axisB 
label axisA, "axisA" 
label axisB, "axisB" 
dist rotaxis, axisA, axisB
color green, rotaxis
set dash_width, 5
set dash_gap, 0
hide label, rotaxis

####################### Create rotate states of dye atoms ###################
##### First mutate, the mutate functions take 0.2 seconds, so we put in a refesh command to wait for everything is done
rotkit.mutate("1HP1", chain="A", resi=308, target="CYS", mutframe=1)
cmd.refresh()
rotkit.mutate("1HP1", chain="A", resi=513, target="CYS", mutframe=1)
cmd.refresh()

##### Create simulated dye movement atoms
pseudoatom Donor, vdw=0.5
pseudoatom Acceptor, vdw=0.5
show spheres, Donor or Acceptor 
rotkit.toline("1HP1 and resi 308 and name CA","1HP1 and resi 308 and name SG","Donor","Donor",15.0)
rotkit.toline("1HP1 and resi 513 and name CA","1HP1 and resi 513 and name SG","Acceptor","Acceptor",15.0)

python
Dye_ang_incr = 6
Donor_angle_range = range(0,359,Dye_ang_incr)
Acceptor_angle_range = range(0,359,Dye_ang_incr)
nrstates = len(Donor_angle_range)+1
Donor_states = 1
Acceptor_states = 1
for Donor_angle in Donor_angle_range:
    Donor_states += 1
    Donor_angle_name="Donor_%s"%(Donor_angle)
    cmd.create(Donor_angle_name,"Donor")
    rotkit.rotateline("1HP1 and resi 308 and name CA","1HP1 and resi 308 and name CB",Donor_angle,Donor_angle_name)
    # Save it as states in Donor
    cmd.create("Donor",Donor_angle_name,1,Donor_states)
    cmd.create("Donor",Donor_angle_name,1,2*nrstates-Donor_states)
    cmd.group("All_Donors",Donor_angle_name)
for Acceptor_angle in Acceptor_angle_range:
    Acceptor_states += 1
    Acceptor_angle_name="Acceptor_%s"%(Acceptor_angle)
    cmd.create(Acceptor_angle_name,"Acceptor")
    rotkit.rotateline("1HP1 and resi 513 and name CA","1HP1 and resi 513 and name CB",Acceptor_angle,Acceptor_angle_name)
    # Save it as states in Acceptor
    cmd.create("Acceptor",Acceptor_angle_name,1,Acceptor_states)
    cmd.create("Acceptor",Acceptor_angle_name,1,2*nrstates-Acceptor_states)
    cmd.group("All_Acceptors",Acceptor_angle_name)
python end
disable All_Donors
disable All_Acceptors
cmd.create("Donor","All_Donors",1,1)
cmd.create("Acceptor","All_Acceptors",1,1)
mplay</pre>

<h3 id="示例3-创建距离分布直方图"><a href="#示例3-创建距离分布直方图" class="headerlink" title="示例3-创建距离分布直方图"></a>示例3-创建距离分布直方图</h3><pre class="EnlighterJSRAW" data-enlighter-language="python">reinitialize
import rotkit

fetch 1HP1, async=0
show_as cartoon, 1HP1
show_as sticks, 1HP1 and resn ATP
set auto_zoom, off

####################### Create rotate states of dye atoms ###################
##### First mutate, the mutate functions take 0.2 seconds, so we put in a refesh command to wait for everything is done
rotkit.mutate("1HP1", chain="A", resi=308, target="CYS", mutframe=1)
cmd.refresh()
rotkit.mutate("1HP1", chain="A", resi=513, target="CYS", mutframe=1)
cmd.refresh()

##### Create simulated dye movement atoms
pseudoatom Donor, vdw=0.5
pseudoatom Acceptor, vdw=0.5
show spheres, Donor or Acceptor 
rotkit.toline("1HP1 and resi 308 and name CA","1HP1 and resi 308 and name SG","Donor","Donor",15.0)
rotkit.toline("1HP1 and resi 513 and name CA","1HP1 and resi 513 and name SG","Acceptor","Acceptor",15.0)

python
Dye_ang_incr = 6
Donor_angle_range = range(0,359,Dye_ang_incr)
Acceptor_angle_range = range(0,359,Dye_ang_incr)
Donor_names = []
Acceptor_names = []
for Donor_angle in Donor_angle_range:
    Donor_angle_name="Donor_%s"%(Donor_angle)
    Donor_names.append([Donor_angle,Donor_angle_name])
    cmd.create(Donor_angle_name,"Donor")
    rotkit.rotateline("1HP1 and resi 308 and name CA","1HP1 and resi 308 and name CB",Donor_angle,Donor_angle_name)
    cmd.group("All_Donors",Donor_angle_name)
for Acceptor_angle in Acceptor_angle_range:
    Acceptor_angle_name="Acceptor_%s"%(Acceptor_angle)
    Acceptor_names.append([Acceptor_angle,Acceptor_angle_name])
    cmd.create(Acceptor_angle_name,"Acceptor")
    rotkit.rotateline("1HP1 and resi 513 and name CA","1HP1 and resi 513 and name CB",Acceptor_angle,Acceptor_angle_name)
    cmd.group("All_Acceptors",Acceptor_angle_name)
python end
disable All_Donors
disable All_Acceptors
cmd.create("Donor","All_Donors")
cmd.create("Acceptor","All_Acceptors")
cmd.refresh()

# Make a distribution for the Open case
Don_Acc_distribution = []
python
for Don in Donor_names:
    for Acc in Acceptor_names:
        distname = "%s_%s"%(Don[1],Acc[1])
        distance = cmd.dist(distname,Don[1],Acc[1])
        Don_Acc_distribution.append([Don[0], Acc[1], distance])
        cmd.delete(distname)
python end
Newdir=rotkit.createdirs("results_rotkit")
os.chdir(Newdir) 
rotkit.makehistogram(Don_Acc_distribution,dataname="Don_Acc_Open",datalistindex=2,nrbins=100,binrange=[0,0])

# Make a distribution for angle range
cmd.create("Acceptor_rot","All_Acceptors")
python
ang_incr = 1
anglerange = range(2,98,ang_incr)
nrstates = len(anglerange)+1
states = 1
for angle in anglerange:
    states += 1
    rot_Acceptor = "Acceptor_rot_%s"%angle
    cmd.create(rot_Acceptor,"Acceptor_rot")
    rotkit.rotateline("/1HP1//A/423/CG1","/1HP1//A/477/C",-(angle-1),rot_Acceptor)  
    cmd.create("Acceptor_rot",rot_Acceptor,1,states)
    cmd.create("Acceptor_rot",rot_Acceptor,1,2*nrstates-states)
    cmd.delete(rot_Acceptor)
    for Acc in Acceptor_names:
        rotkit.rotateline("/1HP1//A/423/CG1","/1HP1//A/477/C",(angle-1),Acc[1])
python end
mplay</pre>

<h3 id="示例5-功能向导文件"><a href="#示例5-功能向导文件" class="headerlink" title="示例5-功能向导文件"></a>示例5-功能向导文件</h3><pre class="EnlighterJSRAW" data-enlighter-language="python">reinitialize
import rotkit

fetch 1HP1, async=0
python
if 'PYMOL_GIT_MOD' in os.environ:
    example_dir = os.path.join(os.path.split(os.environ['PYMOL_GIT_MOD'])[0],"files_for_examples")
    cmd.load(os.path.join(example_dir,"Atto590.pdb"))
else:
    cmd.load("Atto590.pdb")
python end
# Make sure everything is loaded before we continue
cmd.refresh()

### Get the names of the loaded objects
protname = cmd.get_names()[0]
molname = cmd.get_names()[1]

### Make the names we are going to use
protselectCB="%s and resi 308 and name CB"%protname
protnameselectCB="K308CB"
protselectCA="%s and resi 308 and name CA"%protname
protnameselectCA="K308CA"
molselect13="%s and id 13"%molname
molnameselect13="dyeatom13"
molselect12="%s and id 12"%molname
molnameselect12="dyeatom12"

### Make some selections
cmd.select("%s"%protnameselectCB,"%s"%protselectCB)
cmd.select("%s"%protnameselectCA,"%s"%protselectCA)
cmd.select("%s"%molnameselect13,"%s"%molselect13)
cmd.label("%s"%molnameselect13,"13")
cmd.select("%s"%molnameselect12,"%s"%molselect12)
cmd.label("%s"%molnameselect12,"12")

### Make nice representations
cmd.show_as("cartoon","%s"%protname)
cmd.show("sticks","byres %s"%protnameselectCB)

##### PART I: Use of functions #####
### This view will take you to the first part
set_view (\
     0.377224118,    0.880101919,   -0.288305759,\
     0.661396861,   -0.473919988,   -0.581338286,\
    -0.648268998,    0.028612033,   -0.760871351,\
     0.000000000,    0.000000000,  -56.408561707,\
    19.480533600,   34.572898865,    6.978204727,\
    46.615653992,   66.201446533,  -20.000001907 )

#### Just unhash each part for itself, as you continue through
### To print a objects TTT matrix in a readable format
rotkit.printMat(cmd.get_object_matrix(molname))

##### We want to move the dye to a desired location, and rotate it to a view we desire
##### First get the vector bewteen the dyeatom and the protein atom
diffvector = rotkit.vector("%s"%molselect13,"%s"%protnameselectCB)
##### Then move the dye
move = rotkit.transmat(diffvector)
##### print the matrix for fun
rotkit.printMat(move)
##### Move the dye
cmd.transform_selection("%s"%molname,move)

##### Now we want to displace the dye in the CA-CB bond direction
##### First find the vector/direction to displace it in. From A -&gt; B
diffvector = rotkit.vector("%s"%protnameselectCA,"%s"%protnameselectCB)
##### Make the vector so its lenth is equal 1
uvector = rotkit.unitvector(diffvector)[0]
##### Make the move translation matrix, and we multiply the matrix with 3, so it moves 3 Angstrom
move = rotkit.transmat(uvector,3)
##### Print the matrix
rotkit.printMat(move)
##### Displace it in the CA-CB direction
cmd.transform_selection("%s"%molname,move)

##### Now we want to rotate it a single time. We convert 40 degress to radians
##### The input is the angle, the line to rotate around, and a point where the line goes through
CBxyz = rotkit.getxyz("%s"%protnameselectCB)[0]
rmat = rotkit.rotmat(rotkit.radangle(40),uvector,CBxyz)
rotkit.printMat(rmat)
##### Copy paste this line into pymol to see it manually
cmd.transform_selection("%s"%molname,rmat)

##### We are not quite satisfied, we want to rotate it around its own bond
##### So we rotate in around its own 13 -&gt; 12 bonds
diffvector = rotkit.vector("%s"%molnameselect13,"%s"%molnameselect12)
uvector = rotkit.unitvector(diffvector)[0]
xyz12 = rotkit.getxyz("%s"%molnameselect12)[0]
rmat = rotkit.rotmat(rotkit.radangle(10),uvector,xyz12)
##### Copy paste this line into pymol to see it manually
cmd.transform_selection("%s"%molname,rmat)

##### Now, lets make a function that collects all these call in one function
##### We only want to define two positions that defines the line, the angle and the object to rotate
rotkit.rotateline("%s"%molnameselect13,"%s"%molnameselect12,180,"%s"%molname)
##### This is made as a pymol command as well. I first print the names that we should write manually in the consol
print("rotateline Pos1=%s, Pos2=%s, degangle=15, molecule=%s"%(molnameselect13, molnameselect12, molname))

##### To illustate best, we create som copies of the dye
python
anglerange = range(90,360,90)
for angle in anglerange:
    ### Make a suitable name for the new molecule
    molanglename="%s%s"%(molname,angle)
    ### Now make a copy
    cmd.create(molanglename,molname)
    cmd.label("%s and id 12"%molanglename,"12")
    cmd.label("%s and id 13"%molanglename,"13")
    ### Rotate the copy
    rotkit.rotateline("%s"%protnameselectCB,"%s"%molnameselect13,angle,"%s"%molanglename)
python end

####### End of PART I ####
####### PART II: More advanced functions #####
##### This view will take you to the second part
set_view (\
     0.723298192,    0.467510879,    0.508201897,\
     0.371686131,   -0.883831143,    0.284063697,\
     0.581970334,   -0.016570913,   -0.813038886,\
     0.000000000,    0.000000000,  -76.609786987,\
    11.790571213,   64.992294312,   20.803859711,\
   -31.181428909,  184.401092529,  -20.000001907 )

##### We can fast mutate a protein. frame 1 is the most probable mutation
rotkit.mutate(protname, chain="A", resi=513, target="CYS", mutframe=1)
##### The mutate functions take 0.2 seconds, so we put in a refesh command to wait for everything is done
cmd.refresh()
##### This is made as a pymol command as well. I first print the names that we should write manually in the consol
print("mutate %s, chain=%s, resi=%s, target=CYS, mutframe=1"%(protname, "A", 515))

##### We now make some selections for this mutation
protselectCBcys="%s and resi 513 and name CB"%protname
protnameselectCBcys="P513C_CB"
protselectCAcys="%s and resi 513 and name CA"%protname
protnameselectCAcys="P513C_CA"
cmd.select("%s"%protnameselectCBcys,"%s"%protselectCBcys)
cmd.select("%s"%protnameselectCAcys,"%s"%protselectCAcys)

##### Now, lets make a function that collects all the commands to put on an atom on the same line defined by two points
##### The input is the two points that define the line, the atom of a molecule to be put on the line, and the distance to move
rotkit.toline(protnameselectCAcys,protnameselectCBcys,molnameselect13,molname,3)
rotkit.rotateline(protnameselectCAcys,protnameselectCBcys,180,molname)
rotkit.rotateline(molnameselect13,molnameselect12,10,molname)
print("toline Pos1=%s, Pos2=%s, atom=%s, molecule=%s, dist=%s"%(protnameselectCAcys,protnameselectCBcys,molnameselect13,molname,3))
print("rotateline Pos1=%s, Pos2=%s, degangle=180, molecule=%s"%(protnameselectCAcys, protnameselectCBcys, molname))
print("rotateline Pos1=%s, Pos2=%s, degangle=10, molecule=%s"%(molnameselect13, molnameselect12, molname))
cmd.refresh()
####### End of PART II ####

####### Now we make a cross product ####
molselect14="%s and id 14"%molname
molnameselect14="dyeatom14"
cmd.select("%s"%molnameselect14,"%s"%molselect14)
cmd.label("%s"%molnameselect14,"14")

cross = rotkit.crossprod(rotkit.vector(molselect13,molselect12),rotkit.vector(molselect13,molselect14))
unity_cross = rotkit.unitvector(cross)[0]
point_cross = rotkit.crosspoint(molselect13,cross)
rotkit.rotateline(molnameselect13,point_cross,180,molname)
print("rotateline Pos1=%s, Pos2=%s, degangle=10, molecule=%s"%(molnameselect13, point_cross, molname))</pre>

<p>&nbsp;</p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-10-18T12:17:14.231Z" itemprop="dateUpdated">2017-10-18 20:17:14</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/714.html" target="_blank" rel="external">http://kangsgo.com/714.html</a>
        
    </div>
    <footer>
        <a href="http://kangsgo.com">
            <img src="/img/avatar.jpg" alt="kangsgo">
            kangsgo
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/714.html&title=《Pymol小脚本之Rotkit》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/714.html&title=《Pymol小脚本之Rotkit》 — 小康博客&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/714.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Pymol小脚本之Rotkit》 — 小康博客&url=http://kangsgo.com/714.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/714.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/717.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">一个快速修改PDB中残基编号的脚本</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/706.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Pymol 选择速查手册</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>kangsgo &copy; 2015 - 2017</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/714.html&title=《Pymol小脚本之Rotkit》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/714.html&title=《Pymol小脚本之Rotkit》 — 小康博客&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/714.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Pymol小脚本之Rotkit》 — 小康博客&url=http://kangsgo.com/714.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/714.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAByklEQVR42u3awQrCQAyEYd//pRU8CdrtTCabVvh7KkW6Xz2E7GQfD/l6vq/P+8/r+7nyNuWXxQsuXLgx97m8jrjr+yPW+n5tgAsX7jxXL156MVovvP7Uw+dw4cK9GdftOmpFDS5cuP/FdbdAN627cOHClbnK5sddPv89XLhwr+LWAtPe++35Lly4cJumEkp46kalevH6sTpcuHBHuPryycbGHdyevAEuXLiXcpMoRI9K3QEMXLhwd3P1UmI3InHr8+M9cOHCHeHW+oe8JXKLptQlwYULt5XrDjt1XFcJO2l04MKF28rtbVzy4xfRNBguXLitXB1RC0CVECSa9MKFC3cbt1aY3PLkbpkOUxy4cOFu47pNyTqw2PEeuHDhznPdgMMNO9xN0UnJgwsX7gjXjTL1JzrOLWpw4cLdzdXLSu0D9IGr9Blw4cId5CYBqF6elPD0ZIMEFy7cQW5t1OrOOJJxiz0ThgsXbsB1C4qLSA57uSNeuHDh9nKTCMMdqeZtE1y4cCe5+eZHH7vWzl/BhQv3ntza8U33bW2FDC5cuIPcZPna4DYqZHDhwg24tSNTeTBq/1lw4cId4dYCU3cEojdGeuQKFy7cDdwXCvgbMTFsGlQAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
