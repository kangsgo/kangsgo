<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>LigParGen:配体OPLS/CM1A力场在线生成 | 小康博客 | 计算化学与分子模拟爱好者</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="gromacs">
    <meta name="description" content="LigParGen是一个提供有机分子或者配体力场的在线服务网站，其能够提供键长，二面角以及Lennard-Jones OPLS-AA参数，电荷算法为1.14*CM1A或1.14*CM1A-LBCC。生成的配体力场可以非常容易的在Gromacs，NAMD以及OpenMM中使用，文章中说明将在不久提供Amber软件的支持。最大配体原子大小不超过200个原子，计算模型的电荷最大为正负2。  该在线服务">
<meta name="keywords" content="gromacs">
<meta property="og:type" content="article">
<meta property="og:title" content="LigParGen:配体OPLS&#x2F;CM1A力场在线生成">
<meta property="og:url" content="http://kangsgo.com/681.html">
<meta property="og:site_name" content="小康博客">
<meta property="og:description" content="LigParGen是一个提供有机分子或者配体力场的在线服务网站，其能够提供键长，二面角以及Lennard-Jones OPLS-AA参数，电荷算法为1.14*CM1A或1.14*CM1A-LBCC。生成的配体力场可以非常容易的在Gromacs，NAMD以及OpenMM中使用，文章中说明将在不久提供Amber软件的支持。最大配体原子大小不超过200个原子，计算模型的电荷最大为正负2。  该在线服务">
<meta property="og:locale" content="zh">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-84395c51d30fa58e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-aa47d185302f7952.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-fa588b9afd167175.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-b7fdd584e10762c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-fd52863938451991.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-a7230645a3b9eb4e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-1ffdccc41a3972cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-bb4eb79ee176d86f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/903467-dae3a85fe48cb4f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2017-10-28T04:05:23.210Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LigParGen:配体OPLS&#x2F;CM1A力场在线生成">
<meta name="twitter:description" content="LigParGen是一个提供有机分子或者配体力场的在线服务网站，其能够提供键长，二面角以及Lennard-Jones OPLS-AA参数，电荷算法为1.14*CM1A或1.14*CM1A-LBCC。生成的配体力场可以非常容易的在Gromacs，NAMD以及OpenMM中使用，文章中说明将在不久提供Amber软件的支持。最大配体原子大小不超过200个原子，计算模型的电荷最大为正负2。  该在线服务">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/903467-84395c51d30fa58e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
        <link rel="alternate" type="application/atom+xml" title="小康博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">kangsgo</h5>
          <a href="mailto:kangsgo@vip.qq.com" title="kangsgo@vip.qq.com" class="mail">kangsgo@vip.qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/kangsgo" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.aspirincode.com/"  >
                <i class="icon icon-lg icon-link"></i>
                AspirinCode
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://liangtian.me/"  >
                <i class="icon icon-lg icon-liantian"></i>
                LiangTian
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">LigParGen:配体OPLS/CM1A力场在线生成</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">LigParGen:配体OPLS/CM1A力场在线生成</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-08-10T08:06:49.000Z" itemprop="datePublished" class="page-time">
  2017-08-10
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子模拟/">分子模拟</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#理论基础"><span class="post-toc-number">1.</span> <span class="post-toc-text">理论基础</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#LigParGen使用方法"><span class="post-toc-number">2.</span> <span class="post-toc-text">LigParGen使用方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#蛋白配体复合物模拟"><span class="post-toc-number">3.</span> <span class="post-toc-text">蛋白配体复合物模拟</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-准备蛋白配体系统"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1.准备蛋白配体系统</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1-1-获得复合物"><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">1.1 获得复合物</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1-2-模拟前的蛋白准备工作"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">1.2 模拟前的蛋白准备工作</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1-3-准备配体"><span class="post-toc-number">3.1.3.</span> <span class="post-toc-text">1.3 准备配体</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-设置Gromacs模拟"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">2 设置Gromacs模拟</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2-1-结合蛋白配体坐标"><span class="post-toc-number">3.2.1.</span> <span class="post-toc-text">2.1 结合蛋白配体坐标</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2-2-蛋白配体拓扑结合"><span class="post-toc-number">3.2.2.</span> <span class="post-toc-text">2.2 蛋白配体拓扑结合</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2-3-设置MD模拟"><span class="post-toc-number">3.2.3.</span> <span class="post-toc-text">2.3 设置MD模拟</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-LigParGen配体OPLSCM1A力场在线生成"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">LigParGen:配体OPLS/CM1A力场在线生成</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-08-10 16:06:49" datetime="2017-08-10T08:06:49.000Z"  itemprop="datePublished">2017-08-10</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子模拟/">分子模拟</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <blockquote>
<p>LigParGen是一个提供有机分子或者配体力场的在线服务网站，其能够提供键长，二面角以及Lennard-Jones OPLS-AA参数，电荷算法为1.14*CM1A或1.14*CM1A-LBCC。生成的配体力场可以非常容易的在Gromacs，NAMD以及OpenMM中使用，文章中说明将在不久提供Amber软件的支持。最大配体原子大小不超过200个原子，计算模型的电荷最大为正负2。</p>
</blockquote>
<p>该在线服务器的使用方法非常的简单，并且使用的电荷计算模型1.14<em>CM1A在OPLS-AA力场中水化自由能计算（hydration free energies ，HFE）与实验具有良好的拟合效果，而改进的局部电荷校正（LBCC）方法更加提供了电荷的精确度，称之为1.14\</em>CM1A-LBCC模型。在在线服务中，对于不带电的小分子提供1.14*CM1A和1.14*CM1A-LBCC模型，而带电荷的分子仅提供不放大1.14倍的CM1A模型。故带电荷的小分子还是最好使用GAFF力场制作方法。</p>
<p>LigParGen服务网址为:<a href="http://zarbi.chem.yale.edu/ligpargen/index.html" target="_blank" rel="external">http://zarbi.chem.yale.edu/ligpargen/index.html</a></p>
<h3 id="理论基础"><a href="#理论基础" class="headerlink" title="理论基础"></a>理论基础</h3><p>CM1A方法使用来自于电荷密度的Mulliken分布分析，而电荷密度获得的方式为AM1方法基于配体几何计算，<strong>*故配体几何的差别会导致电荷计算轻微差别，但影响不大。</strong><br>Mulliken电荷对原子A的计算方法大致如下(具体可以查看参考文献4)：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-84395c51d30fa58e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p><em>q<sub>A</sub></em>是部分Mulliken 电荷，<em>Z<sub>A</sub></em>是原子A的中性电荷，<em>N<sub>A</sub></em>是原子A的电荷密度分布，计算方法如下:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-aa47d185302f7952.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-fa588b9afd167175.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p><em>N</em>是分子的总电荷数，<em>C<sub>n,i </sub></em>为分子轨道系数，<em>χ<sub>n</sub></em> 和<em>S<sub>nk</sub></em>QM多重积分，但1.14*CM1A电荷模型在苯环，醚类和酮类中参数不理想， 在426个有机分子的测试集中和实验数据相比mean unsigned error (MUE)达到1.5kcal/mol，而改进的局部电荷校正（LBCC）方法具有更好的效果。<br>作者进行了水化自由能（HFE）的评价，模拟的计算方法软件采用的NAMD，一共计算了10个分子，每个分子进行了36个窗口计算，每个窗口模拟1ns，力场采用OPLS-AA/1.14*CM1A-LBCC，水采用的TIP3P，完成参数请看底部的参考文献3。实验结果与模拟的结果拟合的较好，结果如下:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-b7fdd584e10762c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>说明模拟结果和实验结果拟合的非常棒！</p>
<h3 id="LigParGen使用方法"><a href="#LigParGen使用方法" class="headerlink" title="LigParGen使用方法"></a>LigParGen使用方法</h3><p>LigParGen的使用方法非常的简单:<br>首先上传MOL或者PDB文件或者SMILES Code:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-fd52863938451991.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>当然也可以通过JSME自己画，如下图:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-a7230645a3b9eb4e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>首先点一下Make SMILES，画完以后再点击一下Make SMILES即可。</p>
<p>然后选择电荷模型，是否优化分子，分子电荷等选项。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-1ffdccc41a3972cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>之后便可以下载不同软件需要用到的文件。软件的工作流程如下:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/903467-bb4eb79ee176d86f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="蛋白配体复合物模拟"><a href="#蛋白配体复合物模拟" class="headerlink" title="蛋白配体复合物模拟"></a>蛋白配体复合物模拟</h3><p>LigParGen提供了3种模拟软件的蛋白配体复合物模拟的方法，可以在官网上查看，我们这里翻译GROMACS的蛋白配体复合物模拟。</p>
<h4 id="1-准备蛋白配体系统"><a href="#1-准备蛋白配体系统" class="headerlink" title="1.准备蛋白配体系统"></a>1.准备蛋白配体系统</h4><p>Gromacs，Chimera和python被要求安装。</p>
<h5 id="1-1-获得复合物"><a href="#1-1-获得复合物" class="headerlink" title="1.1 获得复合物"></a>1.1 获得复合物</h5><p>使用T4溶菌酶L99A与苯环分子复合物（PDB ID:4W52）作为教程，结构如下图，仅包含一条链<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://upload-images.jianshu.io/upload_images/903467-dae3a85fe48cb4f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="T4 Lysozyme L99A with Benzene" title="">
                </div>
                <div class="image-caption">T4 Lysozyme L99A with Benzene</div>
            </figure></p>
<h5 id="1-2-模拟前的蛋白准备工作"><a href="#1-2-模拟前的蛋白准备工作" class="headerlink" title="1.2 模拟前的蛋白准备工作"></a>1.2 模拟前的蛋白准备工作</h5><p>清理蛋白使用Chimera的对接准备功能（dockprep ），增加缺失残基使用Dunbrack rotamer库，这一部并不会进行蛋白加氢，因为在后面pdb2gmx会对蛋白进行加氢。Chimera脚本如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## PDB_FILE SHOULD THE COMPLETE PATH OF THE FILE</span></div><div class="line"><span class="comment">## REPLACE BNZ with LIGAND resname </span></div><div class="line"><span class="comment">## USAGE: Chimera --nogui --script "prep_prot_lig.py 4w52.pdb BNZ" </span></div><div class="line"><span class="keyword">import</span> chimera</div><div class="line"><span class="keyword">from</span> DockPrep <span class="keyword">import</span> prep</div><div class="line"><span class="keyword">import</span> Midas</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> os</div><div class="line">PDB_file = sys.argv[<span class="number">1</span>] </div><div class="line">lig_name = sys.argv[<span class="number">2</span>]</div><div class="line">os.system(<span class="string">'grep ATOM %s &gt; %s_clean.pdb'</span>%(PDB_file,PDB_file[:<span class="number">-4</span>]))</div><div class="line">os.system(<span class="string">'grep %s  %s &gt; %s.pdb'</span>%(lig_name,PDB_file,lig_name))</div><div class="line">protein=chimera.openModels.open(<span class="string">'%s_clean.pdb'</span>%PDB_file[:<span class="number">-4</span>])</div><div class="line">ligand=chimera.openModels.open(<span class="string">'%s.pdb'</span>%lig_name)</div><div class="line">prep(protein,addHFunc=<span class="keyword">None</span>,addCharges=<span class="keyword">False</span>)</div><div class="line">prep(ligand)</div><div class="line">Midas.write(protein,<span class="keyword">None</span>,<span class="string">"protein_clean.pdb"</span>)</div><div class="line">Midas.write(ligand,<span class="keyword">None</span>,<span class="string">"ligand_wH.pdb"</span>)</div></pre></td></tr></table></figure>
<p>使用脚本:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Chimera --nogui --script <span class="string">"prep_prot_lig.py 4w52.pdb BNZ"</span></div></pre></td></tr></table></figure></p>
<p>生成的 protein_clean.pdb和ligand_wH.pdb将会在随后使用。</p>
<h5 id="1-3-准备配体"><a href="#1-3-准备配体" class="headerlink" title="1.3 准备配体"></a>1.3 准备配体</h5><p>使用的方法如第2部分，后下载BNZ.gro（坐标文件）与BNZ.itp（拓扑文件）</p>
<h4 id="2-设置Gromacs模拟"><a href="#2-设置Gromacs模拟" class="headerlink" title="2 设置Gromacs模拟"></a>2 设置Gromacs模拟</h4><h5 id="2-1-结合蛋白配体坐标"><a href="#2-1-结合蛋白配体坐标" class="headerlink" title="2.1 结合蛋白配体坐标"></a>2.1 结合蛋白配体坐标</h5><p><strong>其Gromacs版本使用的为4.6.5</strong>，若使用的为5.x或者2016版本可以具体查看李继存老师翻译的配体蛋白教程的后续命令。差别不大。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pdb2gmx -f protein_clean.pdb -o protein_processed.gro -water spce</div></pre></td></tr></table></figure></p>
<p>两个蛋白的结合可以手动或者使用如下脚本完成:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line">pro_gro = sys.argv[<span class="number">1</span>]</div><div class="line">lig_gro = sys.argv[<span class="number">2</span>]</div><div class="line">pro = open(pro_gro,<span class="string">'r'</span>).readlines()</div><div class="line">lig = open(lig_gro,<span class="string">'r'</span>).readlines()</div><div class="line">pro_dat = [line.rstrip() <span class="keyword">for</span> line <span class="keyword">in</span> pro]</div><div class="line">lig_dat = [line.rstrip() <span class="keyword">for</span> line <span class="keyword">in</span> lig]</div><div class="line">tot_num = int(pro_dat[<span class="number">1</span>])+int(lig_dat[<span class="number">1</span>])</div><div class="line">com_dat = [pro_dat[<span class="number">0</span>],<span class="string">'%5d'</span>%tot_num]+pro_dat[<span class="number">2</span>:<span class="number">-1</span>] + lig_dat[<span class="number">2</span>:<span class="number">-1</span>] + [pro_dat[<span class="number">-1</span>]]</div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> com_dat: <span class="keyword">print</span> line</div></pre></td></tr></table></figure></p>
<p>运行脚本<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python combineGro_prot_lig.py protein_processed.gro BNZ.gro &gt; complex.gro</div></pre></td></tr></table></figure></p>
<h5 id="2-2-蛋白配体拓扑结合"><a href="#2-2-蛋白配体拓扑结合" class="headerlink" title="2.2 蛋白配体拓扑结合"></a>2.2 蛋白配体拓扑结合</h5><p>我们对拓扑文件(topol.top)进行修改。<br>在<code>#include &quot;oplsaa.ff/forcefield.itp&quot;</code>后加上<code>#include &quot;BNZ.itp&quot;</code>行来merge蛋白和配体。在<code>Protein_chain_A 1</code>后加上<code>BNZ 1</code></p>
<h5 id="2-3-设置MD模拟"><a href="#2-3-设置MD模拟" class="headerlink" title="2.3 设置MD模拟"></a>2.3 设置MD模拟</h5><p>后面的部分与<a href="http://www.jianshu.com/p/5db734581718" target="_blank" rel="external">载脂蛋白模拟部分</a>类似:<br>首先增加水盒子<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">editconf -f complex.gro -o complex_box.gro -c -d 1.0 -bt cubic</div></pre></td></tr></table></figure></p>
<p>填充水:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">genbox -cp complex_box.gro -cs spc216.gro -o complex_box_wSPCE.gro -p topol.top</div></pre></td></tr></table></figure></p>
<p>增加原子:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grompp -f MDP/ions.mdp -c complex_box_wSPCE.gro -p topol.top -o ions.tpr</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">genion -s ions.tpr -o complex_box_wSPCE_ions.gro  -p topol.top -pname NA -nname CL -nn 8</div></pre></td></tr></table></figure>
<p>能量最小化:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">grompp -f MDP/em_real.mdp -c complex_box_wSPCE_ions.gro -p topol.top -o em.tpr</div><div class="line">mdrun -v -deffnm em</div></pre></td></tr></table></figure></p>
<p><strong>一般说来，在进行NVT模拟之前，用户需要增加配体的位置限制从而不会在加热过程中使得配体从蛋白中逃逸</strong><br>位置限制<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">genrestr -f BNZ.gro -o posre_BNZ.itp -<span class="built_in">fc</span> 1000 1000 1000</div></pre></td></tr></table></figure></p>
<p><strong>上面命令会使得posre_BNZ.itp生成，需要在</strong><code>#include &quot;oplsaa.ff/ions.itp&quot;</code><strong>上增加</strong><code>#include &quot;posre_BNZ.itp&quot;</code><strong>的内容</strong><br><strong>为了让蛋白配体系统一起进行温度计算，需要通过如下命令使得两者成为一个体系</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">make_ndx -f em.gro -o index.ndx</div><div class="line"><span class="comment">#选择蛋白和配体选项</span></div><div class="line">1|13</div><div class="line">q</div></pre></td></tr></table></figure></p>
<p>平衡与正式模拟:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">grompp -f nvt.mdp -c em.gro -p topol.top -n index.ndx -o nvt.tpr</div><div class="line">mpirun.lsf mdrun -deffnm nvt</div><div class="line">grompp -f npt.mdp -c nvt.gro -p topol.top -n index.ndx -o npt.tpr</div><div class="line">mpirun.lsf mdrun -deffnm npt</div><div class="line">grompp -f md.mdp -c npt.gro -p topol.top -n index.ndx -o md.tpr</div><div class="line">mpirun.lsf mdrun -deffnm md</div></pre></td></tr></table></figure></p>
<p><strong>如果对配体为进行限制，那么NVT和NPT平衡设置文件中</strong><code>define = -DPOSRES ; position restrain the protein and ligand</code><strong>需要被移去</strong><br>模拟中用到的mdp文件可以在github上下载:<a href="https://github.com/leelasd/ligpargen/tree/master/GMX_LP_MDPS" target="_blank" rel="external">https://github.com/leelasd/ligpargen/tree/master/GMX_LP_MDPS</a></p>
<p>参考文献:</p>
<ol>
<li><p>Potential energy functions for atomic-level simulations of water and organic and biomolecular systems. Jorgensen, W. L.; Tirado-Rives, J. Proc. Nat. Acad. Sci. USA 2005, 102, 6665-6670</p>
</li>
<li><p>1.14*CM1A-LBCC: Localized Bond-Charge Corrected CM1A Charges for Condensed-Phase Simulations. Dodda, L. S.; Vilseck, J. Z.; Tirado-Rives, J.; Jorgensen, W. L. J. Phys. Chem. B. DOI:10.1021/acs.jpcb.7b00272</p>
</li>
<li><p>LigParGen web server: An automatic OPLS-AA parameter generator for organic ligands. Nuc. Acids. Res., DOI: 10.1093/nar/gkx312</p>
</li>
<li><p>Storer J W, Giesen D J, Cramer C J, et al. Class IV charge models: a new semiempirical approach in quantum chemistry.[J]. Journal of computer-aided molecular design, 1995, 9(1):87-110.</p>
</li>
</ol>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-10-28T04:05:23.210Z" itemprop="dateUpdated">2017-10-28 12:05:23</time>
</span><br>


        
        链接：<a href="/681.html" target="_blank" rel="external">http://kangsgo.com/681.html</a>
        
    </div>
    <footer>
        <a href="http://kangsgo.com">
            <img src="/img/avatar.jpg" alt="kangsgo">
            kangsgo
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gromacs/">gromacs</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/681.html&title=《LigParGen:配体OPLS/CM1A力场在线生成》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/681.html&title=《LigParGen:配体OPLS/CM1A力场在线生成》 — 小康博客&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/681.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《LigParGen:配体OPLS/CM1A力场在线生成》 — 小康博客&url=http://kangsgo.com/681.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/681.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/684.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PLIP:蛋白配体联系分析工具</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/670.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">GROMACS之水中部分載脂蛋白</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>kangsgo &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/681.html&title=《LigParGen:配体OPLS/CM1A力场在线生成》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/681.html&title=《LigParGen:配体OPLS/CM1A力场在线生成》 — 小康博客&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/681.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《LigParGen:配体OPLS/CM1A力场在线生成》 — 小康博客&url=http://kangsgo.com/681.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/681.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABxElEQVR42u3aQW4DIQwF0N7/0tNtqjbo22bIVHqsogjBYxYWtvn6isf1Ml7/Wc/JV9s8cHFxx9xrOdZzeiv8PnCyAi4u7nnuu4ixnpNT3rFyAy4u7vO5VzB6R8LFxf3v3CRP6aVSuLi4T+AmqcukpJJccTbnari4uANub8u9v2+p7+Li4ra4V3Gsg9E6bPV2/LECLi7uEW41jcmhe9MnXFzc53DzUJXM7zVmylUcXFzcMTdpkPSKHbsuT3/cyHBxcT/E7f0zaaBGT7hwcXGPcNdXk7w5Onl+kT/ywMXFPcOdX2Umzy+qbRtcXNwz3DzEVENeklD1gh0uLu4ZbrW42Suh5q2UQoEVFxf3Bu46TOQNj94xkvZtIfnBxcXdxJ20WvNnGdUPEc3ExcW9mVtNcpLWbN5SLadbuLi4B7n5NtW26PxJFi4u7qe4SSCbB6zRLQwXF/cI9+7t8/AXrYmLi3uEO2mUzsNT8gmah8HFxR1ze8ErL3ZUU52oiYKLi3uEuw49SREkT5Y252q4uLiP4VbbIdXUq9D5wcXFfQA3KXDsLXng4uJ+itt8OjkujJY/Fi4u7hHupNzZK45Un2vg4uIe5H4DJzHDQvSyVLcAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
