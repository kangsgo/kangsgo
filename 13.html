<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>gromacs中构建非标准氨基酸残基力场 | 小康学习 | 计算化学与分子模拟爱好者</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="Gromacs非标准残基构建李老师其实已经有非常详细的实例来讲解如何进行非标准残基的搭建方法，此方法是之前根据李老师的方法结合amber教程进行改编的方法，可以作为参考。 我们使用ser磷酸化的蛋白作为实验，由于还未发表文章，暂时不提供示例步骤下载。若有问题可以邮件联系我交流：kangsgo#vip.qq.com 1.单独保存非标准残基我们首先使用pymol将sep独立导出12select not">
<meta property="og:type" content="article">
<meta property="og:title" content="gromacs中构建非标准氨基酸残基力场">
<meta property="og:url" content="http://kangsgo.com/13.html">
<meta property="og:site_name" content="小康学习">
<meta property="og:description" content="Gromacs非标准残基构建李老师其实已经有非常详细的实例来讲解如何进行非标准残基的搭建方法，此方法是之前根据李老师的方法结合amber教程进行改编的方法，可以作为参考。 我们使用ser磷酸化的蛋白作为实验，由于还未发表文章，暂时不提供示例步骤下载。若有问题可以邮件联系我交流：kangsgo#vip.qq.com 1.单独保存非标准残基我们首先使用pymol将sep独立导出12select not">
<meta property="og:locale" content="zh">
<meta property="og:image" content="http://kangsgo.com/images/2017/12/gmxhdb.png">
<meta property="og:updated_time" content="2017-12-10T05:13:21.335Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gromacs中构建非标准氨基酸残基力场">
<meta name="twitter:description" content="Gromacs非标准残基构建李老师其实已经有非常详细的实例来讲解如何进行非标准残基的搭建方法，此方法是之前根据李老师的方法结合amber教程进行改编的方法，可以作为参考。 我们使用ser磷酸化的蛋白作为实验，由于还未发表文章，暂时不提供示例步骤下载。若有问题可以邮件联系我交流：kangsgo#vip.qq.com 1.单独保存非标准残基我们首先使用pymol将sep独立导出12select not">
<meta name="twitter:image" content="http://kangsgo.com/images/2017/12/gmxhdb.png">
    
        <link rel="alternate" type="application/atom+xml" title="小康学习" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">kangsgo</h5>
          <a href="mailto:kangsgo@vip.qq.com" title="kangsgo@vip.qq.com" class="mail">kangsgo@vip.qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/kangsgo" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.aspirincode.com/"  >
                <i class="icon icon-lg icon-link"></i>
                AspirinCode
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://liangtian.me/"  >
                <i class="icon icon-lg icon-liantian"></i>
                LiangTian
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://Baidu.com.ru/"  >
                <i class="icon icon-lg icon-bash"></i>
                乐思
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">gromacs中构建非标准氨基酸残基力场</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">gromacs中构建非标准氨基酸残基力场</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-12-09T12:33:22.302Z" itemprop="datePublished" class="page-time">
  2017-12-09
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子模拟/">分子模拟</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Gromacs非标准残基构建"><span class="post-toc-number">1.</span> <span class="post-toc-text">Gromacs非标准残基构建</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-单独保存非标准残基"><span class="post-toc-number">1.0.1.</span> <span class="post-toc-text">1.单独保存非标准残基</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-制作高斯输入文件"><span class="post-toc-number">1.0.2.</span> <span class="post-toc-text">2.制作高斯输入文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-转化为gromacs文件"><span class="post-toc-number">1.0.3.</span> <span class="post-toc-text">3.转化为gromacs文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-整理残基的rtp条目"><span class="post-toc-number">1.0.4.</span> <span class="post-toc-text">4.整理残基的rtp条目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-整理残基的hdb条目"><span class="post-toc-number">1.0.5.</span> <span class="post-toc-text">5.整理残基的hdb条目</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6-模拟尝试"><span class="post-toc-number">1.0.6.</span> <span class="post-toc-text">6.模拟尝试</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-gromacs中构建非标准氨基酸残基力场"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">gromacs中构建非标准氨基酸残基力场</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-12-09 20:33:22" datetime="2017-12-09T12:33:22.302Z"  itemprop="datePublished">2017-12-09</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子模拟/">分子模拟</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Gromacs非标准残基构建"><a href="#Gromacs非标准残基构建" class="headerlink" title="Gromacs非标准残基构建"></a>Gromacs非标准残基构建</h1><p>李老师其实已经有非常详细的实例来讲解如何进行<a href="http://jerkwin.github.io/2017/09/20/GROMACS%E9%9D%9E%E6%A0%87%E5%87%86%E6%AE%8B%E5%9F%BA%E6%95%99%E7%A8%8B2-%E8%8A%8B%E8%9E%BA%E6%AF%92%E7%B4%A0%E5%B0%8F%E8%82%BD%E5%AE%9E%E4%BE%8B/" target="_blank" rel="external">非标准残基</a>的搭建方法，此方法是之前根据李老师的方法结合<a href="http://ambermd.org/tutorials/basic/tutorial5/index.htm" target="_blank" rel="external">amber教程</a>进行改编的方法，可以作为参考。</p>
<p>我们使用ser磷酸化的蛋白作为实验，由于还未发表文章，暂时不提供示例步骤下载。若有问题可以邮件联系我交流：kangsgo#vip.qq.com</p>
<h3 id="1-单独保存非标准残基"><a href="#1-单独保存非标准残基" class="headerlink" title="1.单独保存非标准残基"></a>1.单独保存非标准残基</h3><p>我们首先使用pymol将sep独立导出<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">select <span class="keyword">not</span> resn SEP</div><div class="line">remove sele</div></pre></td></tr></table></figure></p>
<p>将其保存为sep.pdb文件，当然也可以直接用<code>gedit</code>等打开文件，将SEP部分（HETAM）copy导出</p>
<p>sep文件内容如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">ATOM      1  N   SEP A 219      10.386  -7.407  38.687  1.00 31.68           N  </div><div class="line">ATOM      2  CA  SEP A 219      10.979  -8.567  39.325  1.00 31.58           C  </div><div class="line">ATOM      3  C   SEP A 219      12.450  -8.306  39.481  1.00 28.97           C  </div><div class="line">ATOM      4  O   SEP A 219      13.189  -8.279  38.504  1.00 28.84           O  </div><div class="line">ATOM      5  CB  SEP A 219      10.724  -9.808  38.495  1.00  0.00           C  </div><div class="line">ATOM      6  OG  SEP A 219      11.474 -10.889  39.010  1.00  0.00           O  </div><div class="line">ATOM      7  P   SEP A 219      11.419 -12.337  38.313  1.00  0.00           P1+</div><div class="line">ATOM      8  O2P SEP A 219      12.339 -13.139  39.147  1.00  0.00           O1-</div><div class="line">ATOM      9  O1P SEP A 219       9.990 -12.703  38.422  1.00  0.00           O1-</div><div class="line">ATOM     10  O3P SEP A 219      11.893 -12.061  36.938  1.00  0.00           O1-</div><div class="line">ATOM     11  H   SEP A 219      10.767  -7.078  37.811  1.00 31.68           H  </div><div class="line">ATOM     12  HA  SEP A 219      10.534  -8.738  40.305  1.00 31.58           H  </div><div class="line">ATOM     13  HB2 SEP A 219       9.662 -10.058  38.502  1.00  0.00           H  </div><div class="line">ATOM     14  HB3 SEP A 219      11.035  -9.614  37.467  1.00  0.00           H</div></pre></td></tr></table></figure></p>
<p>不难看出带的电荷为-2</p>
<p>我们需要补全两端的氢键(封端)，我是用gview补全的，也可以用pymol,chimera等补全，但是需要注意的是要查看补全的氢键是否正确，我在chimera上补全的氢键就有问题，对于补全氢键，个人的经验觉得正确度排序为:gv&gt;chimera&gt;pymol</p>
<p>补全后如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">HETATM    1  N   SEP A 219      10.386  -7.407  38.687                       N</div><div class="line">HETATM    2  CA  SEP A 219      10.979  -8.567  39.325                       C</div><div class="line">HETATM    3  C   SEP A 219      12.450  -8.306  39.481                       C</div><div class="line">HETATM    4  O   SEP A 219      13.189  -8.279  38.504                       O</div><div class="line">HETATM    5  CB  SEP A 219      10.724  -9.808  38.495                       C</div><div class="line">HETATM    6  OG  SEP A 219      11.474 -10.889  39.010                       O</div><div class="line">HETATM    7  P   SEP A 219      11.419 -12.337  38.313                       P</div><div class="line">HETATM    8  O2P SEP A 219      12.339 -13.139  39.147                       O</div><div class="line">HETATM    9  O1P SEP A 219       9.990 -12.703  38.422                       O</div><div class="line">HETATM   10  O3P SEP A 219      11.893 -12.061  36.938                       O</div><div class="line">HETATM   11  H   SEP A 219      10.767  -7.078  37.811                       H</div><div class="line">HETATM   12  HA  SEP A 219      10.534  -8.738  40.305                       H</div><div class="line">HETATM   13  HB2 SEP A 219       9.662 -10.058  38.502                       H</div><div class="line">HETATM   14  HB3 SEP A 219      11.035  -9.614  37.467                       H</div><div class="line">HETATM   15 2H   SEP A 219      10.544  -6.657  39.329                       H</div><div class="line">HETATM   16  H   SEP A 219      12.857  -8.142  40.457                       H</div><div class="line">TER      16      SEP A 219</div><div class="line">END</div><div class="line">CONECT    1    2   11   15</div><div class="line">CONECT    2    1    3    5   12</div><div class="line">CONECT    3    2    4   16</div><div class="line">CONECT    4    3</div><div class="line">CONECT    5    2    6   13   14</div><div class="line">CONECT    6    5    7</div><div class="line">CONECT    7    6    8    9   10</div><div class="line">CONECT    8    7</div><div class="line">CONECT    9    7</div><div class="line">CONECT   10    7</div><div class="line">CONECT   11    1</div><div class="line">CONECT   12    2</div><div class="line">CONECT   13    5</div><div class="line">CONECT   14    5</div><div class="line">CONECT   15    1</div><div class="line">CONECT   16    3</div></pre></td></tr></table></figure></p>
<h3 id="2-制作高斯输入文件"><a href="#2-制作高斯输入文件" class="headerlink" title="2.制作高斯输入文件"></a>2.制作高斯输入文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">antechamber -<span class="keyword">fi</span> pdb -i sep.pdb -fo gcrt -o sep.gjf -ch <span class="string">"sep.chk"</span> -gm <span class="string">"%mem=2048MB"</span> -gn <span class="string">"%nproc=4"</span> -nc -2</div></pre></td></tr></table></figure>
<p>如果按照李老师的方法还需要使用-ge 生成高斯esp文件，通过iop(6/50=1)，可以参考下面一条命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">antechamber -<span class="keyword">fi</span> pdb -i sep.pdb  -o ligand.gjf -fo gcrt -pf y -gn <span class="string">"%nproc=8"</span> -gm <span class="string">"%mem=1000MB"</span> -ch <span class="string">"ligand"</span> -gk <span class="string">"#HF/6-31G* SCF=tight Test Pop=MK iop(6/33=2) iop(6/42=6) iop(6/50=1) opt"</span> -ge ligand.gesp -gv 1</div></pre></td></tr></table></figure></p>
<p>命令解释如下:<br><code>-fi</code>为输入格式<br><code>-i</code>为输入文件<br><code>-fo</code>为输出文件格式 gcrt为高斯gjf格式<br><code>-ch</code>为高斯chk文件<br><code>-gm -gn</code>为使用内存和核数<br><code>-nc</code> 为电荷数</p>
<h3 id="3-转化为gromacs文件"><a href="#3-转化为gromacs文件" class="headerlink" title="3.转化为gromacs文件"></a>3.转化为gromacs文件</h3><p>实际上与蛋白配体中的小分子制作方式是一样的，首先在这里下载<a href="http://svn.code.sf.net/p/ccpn/code/branches/stable/ccpn/python/acpype/" target="_blank" rel="external">ACPYPE</a>，注意需要下载<strong>sf版本</strong>,否则而面角的表达方式不对，首先生成mol2文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">antechamber -<span class="keyword">fi</span> gout -i sep.log -rn SEP -fo mol2 -o sep.mol2 -c resp -pf y -at amber</div></pre></td></tr></table></figure></p>
<p>在这里最好修改一下原子名称，改成与sep.pdb对应，且需要对其进行修改，因为gromacs加氢从1开始，故将HB2,HB3改为HB1,HB2<br>最后的结果如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">@&lt;TRIPOS&gt;ATOM</div><div class="line">      1 N            3.0030    -1.1500     0.1620 N         1 SEP      -1.141452</div><div class="line">      2 CA           1.8370    -0.4940    -0.4350 CT         1 SEP       0.462377</div><div class="line">      3 C            1.8020     0.9980    -0.1460 C          1 SEP       0.457721</div><div class="line">      4 O            2.8040     1.5940     0.1700 O          1 SEP      -0.633121</div><div class="line">      5 CB           0.5190    -1.1870    -0.0550 CT         1 SEP       0.192426</div><div class="line">      6 OG          -0.5100    -0.6800    -0.7990 OS         1 SEP      -0.641051</div><div class="line">      7 P           -1.7850     0.1390     0.0880 P          1 SEP       1.339193</div><div class="line">      8 O2P         -2.7260     0.5020    -1.0190 O2         1 SEP      -0.920441</div><div class="line">      9 O1P         -2.2370    -0.9110     1.0650 O2         1 SEP      -0.920441</div><div class="line">     10 O3P         -1.0110     1.2850     0.7110 O2         1 SEP      -0.920441</div><div class="line">     11 H            2.7710    -1.3680     1.1160 H          1 SEP       0.367588</div><div class="line">     12 HA           1.9150    -0.5690    -1.5210 H1         1 SEP      -0.041482</div><div class="line">     13 HB1          0.6570    -2.2570    -0.2470 H1         1 SEP      -0.007243</div><div class="line">     14 HB2          0.3490    -1.0790     1.0140 H1         1 SEP      -0.007243</div><div class="line">     15 H2           3.7290    -0.4600     0.2230 H          1 SEP       0.367588</div><div class="line">     16 H1           0.8340     1.4820    -0.2400 HA         1 SEP       0.046022</div><div class="line">....</div></pre></td></tr></table></figure></p>
<p>生成的mol2文件使用<code>parmchk2</code>进行补全参数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">parmchk2 -i sep.mol2 -f mol2 -o sep.frcmod</div></pre></td></tr></table></figure></p>
<p>创建<code>leap.in</code>文件，输入如下内容（注意sep修改成自己的名称）:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">source leaprc.ff99SBildn</div><div class="line">source leaprc.gaff</div><div class="line">loadamberparams sep.frcmod</div><div class="line">lig=loadmol2 sep.mol2</div><div class="line">check lig</div><div class="line">saveamberparm lig sep.prmtop sep.inpcrd</div><div class="line">quit</div></pre></td></tr></table></figure></p>
<p>运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tleap -f leap.in</div></pre></td></tr></table></figure></p>
<p>运行acpype<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python2.7 acpype.py -p sep.prmtop -x sep.inpcrd -d</div></pre></td></tr></table></figure></p>
<p>将会生成<code>SEP_GMX.top</code>和<code>SEP_GMX.gro</code>两个文件，其中<code>SEP_GMX.gro</code>我们用不着</p>
<h3 id="4-整理残基的rtp条目"><a href="#4-整理残基的rtp条目" class="headerlink" title="4.整理残基的rtp条目"></a>4.整理残基的rtp条目</h3><p>为了保存力场<code>rtp</code>信息，我们需要创建一个<code>sep.rtp</code>文件<br>我们需要对<code>SEP_GMX.gro</code>文件进行整理，即把虚拟的原子电荷附加到N端头和C端尾部的位置。<br>如:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[ atoms ]</div><div class="line">;   nr  type  resi  res  atom  cgnr     charge      mass       ; qtot   bond_type</div><div class="line">     1    N     1   SEP     N    1    -1.141453     14.01000 ; qtot -1.141</div><div class="line">     2   CT     1   SEP    CA    2     0.462377     12.01000 ; qtot -0.679</div><div class="line">     3    C     1   SEP     C    3     0.457721     12.01000 ; qtot -0.221</div><div class="line">     4    O     1   SEP     O    4    -0.633122     16.00000 ; qtot -0.854</div><div class="line">     5   CT     1   SEP    CB    5     0.192426     12.01000 ; qtot -0.662</div><div class="line">     6   OS     1   SEP    OG    6    -0.641052     16.00000 ; qtot -1.303</div><div class="line">     7    P     1   SEP     P    7     1.339196     30.97000 ; qtot 0.036</div><div class="line">     8   O2     1   SEP   O2P    8    -0.920442     16.00000 ; qtot -0.884</div><div class="line">     9   O2     1   SEP   O1P    9    -0.920442     16.00000 ; qtot -1.805</div><div class="line">    10   O2     1   SEP   O3P   10    -0.920442     16.00000 ; qtot -2.725</div><div class="line">    11    H     1   SEP     H   11     0.367588      1.00800 ; qtot -2.358</div><div class="line">    12   H1     1   SEP    HA   12    -0.041482      1.00800 ; qtot -2.399</div><div class="line">    13   H1     1   SEP   HB1   13    -0.007243      1.00800 ; qtot -2.406</div><div class="line">    14   H1     1   SEP   HB2   14    -0.007243      1.00800 ; qtot -2.414</div><div class="line">    15    H     1   SEP    H2   15     0.367588      1.00800 ; qtot -2.046</div><div class="line">    16   HA     1   SEP    H1   16     0.046022      1.00800 ; qtot -2.000</div></pre></td></tr></table></figure></p>
<p>1 N的电荷应该变为-1.141453+0.367588<br>3 C的电荷应该变为0.457721+0.046022</p>
<p>然后用我写的<a href="/images/2017/12/rtp.py">脚本</a>进行内容的提取:<br>首先创建<code>config.txt</code>文件，在其中写入需要删除的虚拟原子(每一行一个)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">H</div><div class="line">HA</div></pre></td></tr></table></figure></p>
<p>然后运行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python rtp.py SEP_GMX.top SEP&gt;data.txt</div></pre></td></tr></table></figure></p>
<p>结果如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">[ bondedtypes ]</div><div class="line">; bonds  angles  dihedrals  impropers all_dihedrals nrexcl HH14 RemoveDih</div><div class="line">     1       1          9          4        1         3      1     0</div><div class="line">[ SEP ]</div><div class="line"> [ atoms ]</div><div class="line">      N     N         -0.773865     1</div><div class="line">...</div><div class="line"> [ bonds ]</div><div class="line">      N    CA        1.4620e-01     2.7506e+05</div><div class="line">      N     H        1.0130e-01     3.3740e+05</div><div class="line">     CA     C        1.5240e-01     2.6192e+05</div><div class="line">...</div><div class="line"> [ angles ]</div><div class="line">      N    CA     C      1.0906e+02        5.6066e+02</div><div class="line">      N    CA    CB      1.1161e+02        5.5153e+02</div><div class="line">      N    CA    HA      1.0888e+02        4.1706e+02</div><div class="line">     CA     N     H      1.1768e+02        3.8325e+02</div><div class="line">     CA     C     O      1.2320e+02        5.6400e+02</div><div class="line">...</div><div class="line"> [ dihedrals ] ; propers</div><div class="line">     N    CA     C         O    180.00   0.00000     9</div><div class="line">     N    CA    CB        OG      0.00   0.65084     9</div><div class="line">     N    CA    CB       HB1      0.00   0.65084     9</div><div class="line">     N    CA    CB       HB2      0.00   0.65084     9</div><div class="line">...</div><div class="line"> [ impropers ]</div></pre></td></tr></table></figure></p>
<p>我们需要在[bonds]中增加前一个氨基酸残基的联系连接,[impropers]中增加前后氨基酸残基的联系连接，可以简单的看非标准残基来源的氨基酸残基模板(aminoacids.rtp)或者查看<code>SEP_GMX.top</code>文件中删除的两个氢原子的部分，最后整理结果如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"> [ bonds ]</div><div class="line">     -C     N</div><div class="line">      N    CA        1.4620e-01     2.7506e+05</div><div class="line">      N     H        1.0130e-01     3.3740e+05</div><div class="line">     CA     C        1.5240e-01     2.6192e+05</div><div class="line">     CA    CB        1.5380e-01     2.5179e+05</div><div class="line">...</div><div class="line"> [ impropers ]</div><div class="line">    -C    CA     N     H</div><div class="line">    CA    +N     C     O</div></pre></td></tr></table></figure></p>
<h3 id="5-整理残基的hdb条目"><a href="#5-整理残基的hdb条目" class="headerlink" title="5.整理残基的hdb条目"></a>5.整理残基的hdb条目</h3><p>由于氢键一般有问题，我们需要重新绘制氢键，那么我们创建一个<code>sep.hdb</code>的文件，按照下图来进行设置(图片来源李老师博客):<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2017/12/gmxhdb.png" alt="图" title="">
                </div>
                <div class="image-caption">图</div>
            </figure></p>
<p>结果如下图(可以抄SER的信息):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">SEP  3</div><div class="line">1   1   H    N  -C   CA</div><div class="line">1   5   HA   CA  N   CB    C</div><div class="line">2	6	HB	CB	CA	OG</div></pre></td></tr></table></figure></p>
<h3 id="6-模拟尝试"><a href="#6-模拟尝试" class="headerlink" title="6.模拟尝试"></a>6.模拟尝试</h3><p>将gromacs 目录下(gromacs/share/gromacs/top)中的amber99sb-ildn.ff拷贝至实验目录下（如果找不到可以用which gmx_mpi），将<code>sep.rtp</code>文件和<code>sep.hdb</code>文件放到拷贝出来的amber99sb-ildn.ff目录下。且在top目录下的<code>residuetypes.dat</code>中申明SEP为蛋白，即:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">SEP     Protein ; sep，增加部分</div><div class="line">ABU	Protein</div><div class="line">ACE	Protein</div><div class="line">AIB	Protein</div><div class="line">ALA  	Protein</div><div class="line">ARG  	Protein</div><div class="line">ARGN	Protein</div><div class="line">ASN	Protein</div><div class="line">ASN1  	Protein</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>最后进行模拟尝试看是否可以跑通<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gmx_mpi pdb2gmx -f model.pdb -o model_process.gro -water tip3p -ignh</div></pre></td></tr></table></figure></p>
<p>若提示前一个残基或者末端残基报错，那么检查是否是上述两个文件出错，若提示缺失（SEP的）原子，那么创建<code>sep.atp</code>文件，在<code>SEP_GMX.top</code>,找到提示的缺失原子，放入该文件中，最后将<code>sep.atp</code>文件放到拷贝出来的amber99sb-ildn.ff目录下。</p>
<p>参考资料:<br><a href="http://jerkwin.github.io/2017/09/20/GROMACS%E9%9D%9E%E6%A0%87%E5%87%86%E6%AE%8B%E5%9F%BA%E6%95%99%E7%A8%8B2-%E8%8A%8B%E8%9E%BA%E6%AF%92%E7%B4%A0%E5%B0%8F%E8%82%BD%E5%AE%9E%E4%BE%8B/" target="_blank" rel="external">GROMACS非标准残基教程2-芋螺毒素小肽实例</a><br><a href="http://blog.sina.com.cn/s/blog_6ceaa7650101du7w.html" target="_blank" rel="external">向gromacs中添加小分子力场方法 </a><br><a href="http://blog.csdn.net/sinat_23241095/article/details/53836200" target="_blank" rel="external">amber中非标准氨基酸残基的参数生成</a><br><a href="http://ambermd.org/tutorials/basic/tutorial5/" target="_blank" rel="external">Simulating the Green Fluorescent Protein</a><br><a href="https://jerkwin.github.io/2015/12/08/%E4%BD%BF%E7%94%A8AmberTools+ACPYPE+Gaussian%E5%88%9B%E5%BB%BA%E5%B0%8F%E5%88%86%E5%AD%90GAFF%E5%8A%9B%E5%9C%BA%E7%9A%84%E6%8B%93%E6%89%91%E6%96%87%E4%BB%B6/" target="_blank" rel="external">使用AmberTools+ACPYPE+Gaussian创建小分子GAFF力场的拓扑文件</a></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-12-10T05:13:21.335Z" itemprop="dateUpdated">2017-12-10 13:13:21</time>
</span><br>


        
        链接：<a href="/13.html" target="_blank" rel="external">http://kangsgo.com/13.html</a>
        
    </div>
    <footer>
        <a href="http://kangsgo.com">
            <img src="/img/avatar.jpg" alt="kangsgo">
            kangsgo
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/13.html&title=《gromacs中构建非标准氨基酸残基力场》 — 小康学习&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/13.html&title=《gromacs中构建非标准氨基酸残基力场》 — 小康学习&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/13.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《gromacs中构建非标准氨基酸残基力场》 — 小康学习&url=http://kangsgo.com/13.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/13.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/15.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Open Babel API</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/9.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">mahotas进行细胞统计开胃菜</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>kangsgo &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/13.html&title=《gromacs中构建非标准氨基酸残基力场》 — 小康学习&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/13.html&title=《gromacs中构建非标准氨基酸残基力场》 — 小康学习&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/13.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《gromacs中构建非标准氨基酸残基力场》 — 小康学习&url=http://kangsgo.com/13.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/13.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAAAAAAZai4+AAABYUlEQVR42u3awRKDMAhF0fz/T6cz3VrpexAXws2qU6ueLgwIrCWv/V3Xb67r7uh6YsGC1Yi1w3Vlxbd0z72lw4I1khVvCu5Drvy9PwZYsGClNgUlzMOCBevsBhEnxHGohgULViVpjr/XQ/XhXB4WrBYst5BU+fxgfQsWrNeydmoppd7S9WHBGsZS0t9K70Mv9S7lBFiwmrL0lNctNuWanT/2LViwhrH0xzvX8tQ3DliwprHcER8lkubaM6XJI1iwBrDcG7uNmeQGAQtWO1ZlbC5XSJJeaGHBGsaqPNLubUpBGhas1qzcBqEfdX8JC9Zklt7XcAf4cik4LFhzWJVRA73MZId2WLCGsc7WVPWAXR93gAWrH0t/NdVDe65FKvVgYcFqzdJLS24C7Q7zwYIFy21hui+xRqIMCxasQkjWRwqSsw+wYLVmuU0U9wp22RcWrGGs3DjC2VbogfoWLFhvZX0AGWi7kzsmby4AAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
