<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>SMINA教程以CDPK1为例 | 小康博客 | 计算化学与分子模拟爱好者</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="dock">
    <meta name="description" content="SMINA教程以CDPK1为例 原作者:David Ryan Koes翻译:康文渊 若进行精读建议查看原文以及参考文献，本文是我根据教程快速阅读做的笔记  Q1:我们有autodock vina，为什么还要SMINA？ A1:SMINA有更加优秀的速度和更加的扩展性 Q2:用该对接软件有什么优势？ A2:首先该对接软件为免费/学术免费软件，其次其有非常良好的对接准确度，甚至在商业软件中都为上乘，同">
<meta name="keywords" content="dock">
<meta property="og:type" content="article">
<meta property="og:title" content="SMINA教程以CDPK1为例">
<meta property="og:url" content="http://kangsgo.com/5.html">
<meta property="og:site_name" content="小康博客">
<meta property="og:description" content="SMINA教程以CDPK1为例 原作者:David Ryan Koes翻译:康文渊 若进行精读建议查看原文以及参考文献，本文是我根据教程快速阅读做的笔记  Q1:我们有autodock vina，为什么还要SMINA？ A1:SMINA有更加优秀的速度和更加的扩展性 Q2:用该对接软件有什么优势？ A2:首先该对接软件为免费/学术免费软件，其次其有非常良好的对接准确度，甚至在商业软件中都为上乘，同">
<meta property="og:locale" content="zh">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA1.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA2.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA3.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA4.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA5.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA6.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA9.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA8.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA10.png">
<meta property="og:image" content="http://kangsgo.com/images/2017/smina/SMINA11.png">
<meta property="og:updated_time" content="2017-11-12T06:29:44.946Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SMINA教程以CDPK1为例">
<meta name="twitter:description" content="SMINA教程以CDPK1为例 原作者:David Ryan Koes翻译:康文渊 若进行精读建议查看原文以及参考文献，本文是我根据教程快速阅读做的笔记  Q1:我们有autodock vina，为什么还要SMINA？ A1:SMINA有更加优秀的速度和更加的扩展性 Q2:用该对接软件有什么优势？ A2:首先该对接软件为免费/学术免费软件，其次其有非常良好的对接准确度，甚至在商业软件中都为上乘，同">
<meta name="twitter:image" content="http://kangsgo.com/images/2017/smina/SMINA1.png">
    
        <link rel="alternate" type="application/atom+xml" title="小康博客" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">kangsgo</h5>
          <a href="mailto:kangsgo@vip.qq.com" title="kangsgo@vip.qq.com" class="mail">kangsgo@vip.qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/kangsgo" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.aspirincode.com/"  >
                <i class="icon icon-lg icon-link"></i>
                AspirinCode
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">SMINA教程以CDPK1为例</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">SMINA教程以CDPK1为例</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-11-08T07:04:21.000Z" itemprop="datePublished" class="page-time">
  2017-11-08
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子对接/">分子对接</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#假设和惯例"><span class="post-toc-number">1.</span> <span class="post-toc-text">假设和惯例</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#1-检查C-parvum和T-gondii晶体结构"><span class="post-toc-number"></span> <span class="post-toc-text">1. 检查C.parvum和T.gondii晶体结构</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-1-靶标分析"><span class="post-toc-number">1.</span> <span class="post-toc-text">1.1 靶标分析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-1-1-E-tenella序列分析"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.1.1 E.tenella序列分析</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-1-2-结构分析"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">1.1.2 结构分析</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-2-测试集的创建"><span class="post-toc-number">2.</span> <span class="post-toc-text">1.2 测试集的创建</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-2-1组装活性化合物"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1.2.1组装活性化合物</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-2-2-创建诱饵数据集"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">1.2.2 创建诱饵数据集</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-2-3-生成三维结构"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">1.2.3 生成三维结构</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1-3-对接"><span class="post-toc-number">3.</span> <span class="post-toc-text">1.3 对接</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#2-E-tenella-CDPK1-模型和-测试集预测"><span class="post-toc-number"></span> <span class="post-toc-text">2. E.tenella CDPK1 模型和 测试集预测</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-1-建模"><span class="post-toc-number">1.</span> <span class="post-toc-text">2.1 建模</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-2-对接测试集"><span class="post-toc-number">2.</span> <span class="post-toc-text">2.2 对接测试集</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2-3-用户自定义得分"><span class="post-toc-number">3.</span> <span class="post-toc-text">2.3 用户自定义得分</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#3-虚拟筛选"><span class="post-toc-number"></span> <span class="post-toc-text">3.虚拟筛选</span></a>
        </nav>
    </aside>
    
<article id="post-SMINA教程以CDPK1为例"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">SMINA教程以CDPK1为例</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-11-08 15:04:21" datetime="2017-11-08T07:04:21.000Z"  itemprop="datePublished">2017-11-08</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/分子对接/">分子对接</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>SMINA教程以CDPK1为例</p>
<p>原作者:David Ryan Koes<br>翻译:康文渊</p>
<p>若进行精读建议查看原文以及参考文献，本文是我根据教程快速阅读做的笔记</p>
<blockquote>
<p>Q1:我们有autodock vina，为什么还要SMINA？</p>
<p>A1:SMINA有更加优秀的速度和更加的扩展性</p>
<p>Q2:用该对接软件有什么优势？</p>
<p>A2:首先该对接软件为免费/学术免费软件，其次其有非常良好的对接准确度，甚至在商业软件中都为上乘，同时可以很好的运用SMINA进行得分改造，进一步提升性能和速度</p>
</blockquote>
<p>本教程是一个使用SMINA进行对<em>E.tenella</em>中的钙依赖性蛋白激酶1(calcium-dependent protein kinase 1 CDPK1)进行的结构为基础的虚拟筛选的教程。<em>E.tenella</em>是一种感染幼禽并且导致潜在致命球虫病的寄生虫。尽管这种酶并未解析晶体结构（译者翻译时该结构已经被解析，pdb:4YSJ），但是有相关寄生虫的该种酶的结构。<em>C. parvum</em> 和 <em>T. gondii</em>的该种酶结构已经被解析，并且有生物活性数据表明他们的小分子竭抗剂。<br>我们将会对怎么分析已知结构，评价SMINA对于这些结构的表现，对于对接结果创建自定义的得分函数，使用SWISS-MODEL创建<em>E.tenella</em>的结构模型，并且进行<em>E.tenella</em>CDPK1的虚拟筛选。（个人认为作者提到的<em>E.tenella</em>均表示的为<em>E.tenella</em>CDPK1）。</p>
<h2 id="假设和惯例"><a href="#假设和惯例" class="headerlink" title="假设和惯例"></a>假设和惯例</h2><p>假设读者对Linux命令行有一定的了解，并对一些用到的软件熟悉。教程在Ubuntu Linux12.04（原作者）和Ubuntu Linux16.04（译者）测试通过。bash命令行如下:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">"Hello"</span></div></pre></td></tr></table></figure></p>
<p>python基础的PyMOL环境展示如下:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#python2.x</span></div><div class="line"><span class="keyword">print</span> <span class="string">"Hello"</span></div></pre></td></tr></table></figure></p>
<p>以下为（译者）用到的软件:<br>|–Software–|–License–|–Source–|<br>|—|—|—|<br>|<a href="/images/2017/smina/color_by_mutation.py">color_by_mutation</a>|GNU|<a href="http://www.pymolwiki.org/index.php/Color_By_Mutations|" target="_blank" rel="external">http://www.pymolwiki.org/index.php/Color_By_Mutations|</a><br>|PyMOL 1.7.x|Python|<a href="http://sourceforge.net/projects/pymol/|" target="_blank" rel="external">http://sourceforge.net/projects/pymol/|</a><br>|RDKit 2017_03|BSD Style|<a href="http://rdkit.org/|" target="_blank" rel="external">http://rdkit.org/|</a><br>|smina|GPLv2|<a href="http://sourceforge.net/projects/smina/|" target="_blank" rel="external">http://sourceforge.net/projects/smina/|</a></p>
<h1 id="1-检查C-parvum和T-gondii晶体结构"><a href="#1-检查C-parvum和T-gondii晶体结构" class="headerlink" title="1. 检查C.parvum和T.gondii晶体结构"></a>1. 检查<em>C.parvum</em>和<em>T.gondii</em>晶体结构</h1><p>该部分内容可以参考早期博客文章同源建模系列<br>首先我们分析<em>E.tenella</em>序列和验证三个结构的异同（三个寄生虫中改结构）。然后我们使用<em>C.parvum</em>和<em>T.gondii</em>创建一个虚拟筛选的测试集，并且对接这些测试集化合物。我们使用这些对接结果来进行晶体结构的筛选和模型的增加。</p>
<h2 id="1-1-靶标分析"><a href="#1-1-靶标分析" class="headerlink" title="1.1 靶标分析"></a>1.1 靶标分析</h2><p>首先，我们分析<em>E.tenella</em>序列和<em>C.parvum</em>和<em>T.gondii*</em>结构</p>
<h3 id="1-1-1-E-tenella序列分析"><a href="#1-1-1-E-tenella序列分析" class="headerlink" title="1.1.1 E.tenella序列分析"></a>1.1.1 <em>E.tenella</em>序列分析</h3><p>1.复制或者下载<em>E.tenella</em>的FASTA序列,你可以点击<a href="http://www.ncbi.nlm.nih.gov/protein/CAA96439" target="_blank" rel="external">这里</a>进入网址,同样也可以<a href="/images/2017/smina/CDPK1.fasta">下载</a>我们已经下载好的。</p>
<p>2.进行BLAST搜索，若你为进入的网址，可以直接点击ncbi右侧的BLAST进行搜寻（如下图）。若为下载的文件可以进入<a href="http://blast.ncbi.nlm.nih.gov/Blast.cgi?PROGRAM=blastp" target="_blank" rel="external">BLAST页面</a>上传fasta文件进行搜寻。<br>   <img src="/images/2017/smina/SMINA1.png" alt="图1"></p>
<p>3.进入页面。</p>
<p>   <img src="/images/2017/smina/SMINA2.png" alt="图2"><br>4.点击<strong>BLAST</strong>。</p>
<p>5.结果如图3,可以发现得分最高的为已经解析的结构，相似度为99%，但是我们在这里假装没有。排第二的为Neospora Caninum（4M97），但是更加相近的为<em>T.gondii</em>的几个结构（4M7N，3KU2,<a href="/images/2017/smina/3i79.pdb">3I79</a>,3HX4,3I7C），相似度大于80%。<em>C.parvum</em>的首次命中（3IGO）相似度为62%。</p>
<p>   <img src="/images/2017/smina/SMINA3.png" alt="图3"></p>
<p>从中我们得出的结论为<em>T.gondii</em>的CDPK1相比于<em>C.parvum</em>具有更高的相似度。建议<em>T.gondii</em>结构选为同源建模的模板更为合理。</p>
<h3 id="1-1-2-结构分析"><a href="#1-1-2-结构分析" class="headerlink" title="1.1.2 结构分析"></a>1.1.2 结构分析</h3><p>为了鉴定<em>T.gondii</em>和<em>E.tenella</em>之间CDPK1结合位点的差别，我们创建了一个<em>E.tenella</em>同源模型。并且使用<a href="/images/2017/smina/color_by_mutation.py">color_by_mutation</a>和PyMOL进行结构可视化序列的不同。<br>1.在<a href="http://swissmodel.expasy.org/" target="_blank" rel="external">SWISS-MODEL</a>进行自动建模，你也可以参考之前的教程 </p>
<blockquote>
<p>译者注：我认为该方法并不是建模的最佳方法，最佳方法为找到具有共同抑制剂的晶体结构进行基于配体的多模板建模，这样可以保证重要的活性腔的相似，而不是使用没有结合配体的晶体结构进行建模。</p>
</blockquote>
<p>2.输入<em>E.tenella</em>的FASTA序列和3I79进行建模（图4）</p>
<p>  <img src="/images/2017/smina/SMINA4.png" alt="图4"></p>
<p>3.下载结果文件，你可以在这里<a href="/images/2017/smina/swissmodel.pdb">下载</a>我已经建模好的。</p>
<p>4.在PyMOL中加载模型，3I79和3NCG</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">load swissmodel.pdb</div><div class="line">fetch <span class="number">3</span>I79</div><div class="line">fetch <span class="number">3</span>NCG</div></pre></td></tr></table></figure>
<blockquote>
<p>译者注：在这里<code>3NCG</code>来的有点突然，搜索一下可以发现3NCG为<em>C.parvum</em>的激活状态下的晶体结构</p>
</blockquote>
<p>5.比对结构</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alignto</div></pre></td></tr></table></figure>
<p>6.从3NCG中提取BK1配体，并且隐藏该pdb的其余结构，因为3I79为非结合状态，我们使用这个配体来占有结合位点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">extract bk1,resn BK1</div><div class="line">hide (/<span class="number">3</span>NCG/)</div></pre></td></tr></table></figure>
<p>7.探索模型和3I79结合位点周围的残基，值得注意的是SWISS-MODEL忠实的复制了侧链构像。</p>
<p>8.着色两者之间的突变位点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">run color\_by\_mutation.py</div><div class="line">color\_by\_mutation swissmodel,<span class="number">3</span>i79</div></pre></td></tr></table></figure>
<p>9.探索结合位点，注意的是3I79中GLY128在<em>E.tenella</em>模型中被突变为THR 108，其余在结合位点是大体不变的。</p>
<p>  <img src="/images/2017/smina/SMINA5.png" alt="图5"></p>
<p>10.重复分析3NCG，可以发现<em>C.parvum</em>在结合位点附近具有更多的突变</p>
<h2 id="1-2-测试集的创建"><a href="#1-2-测试集的创建" class="headerlink" title="1.2 测试集的创建"></a>1.2 测试集的创建</h2><p>PubChem上有<em>T.gondii</em>和<em>C.parvum</em>的CDPK1诘抗击。我们使用这些数据作为虚拟筛选的测试集对这两个靶标进行筛选.</p>
<h3 id="1-2-1组装活性化合物"><a href="#1-2-1组装活性化合物" class="headerlink" title="1.2.1组装活性化合物"></a>1.2.1组装活性化合物</h3><p>(a)在<a href="http://pubchem.ncbi.nlm.nih.gov" target="_blank" rel="external">PubChem</a>搜索CDPK1然后排序活性化合物,每个靶点选择三个最大的化合物数据集,为了保证和教程一致,我们选择的为和原教程相同的数据集.<br>    <em>T.gondii</em><br>    aid:677062,600378,672956<br>    <em>C.parvum</em><br>    aid:600379,672955,66097</p>
<p>(b)选择active,然后点击Structures下载,之后选择没有压缩的SMILES格式,可以点此<a href="/images/2017/smina/SMINA.tar.gz">下载</a>我们下载好的</p>
<p>(c)修正SMILES结构。下载的SMILES文件字符串和标题顺序相反。另外，我们需要去除salt，并将关键字“active”添加到所有活性化合物的标题中。我们每个文献执行如下命令（例如aid677062.txt为例）：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">awk <span class="string">'&#123;print $2,$1"_active"&#125;'</span> aid677062.txt | sed <span class="string">'s/\.Cl//'</span> &gt; aid677062.smi</div></pre></td></tr></table></figure></p>
<p>awk主要是进行了前后的颠倒，并且在标题后增加active标签，sed主要是将Cl进行替换，替换成空，中间用管道链接，输出到smi文件格式。</p>
<p>(d)将每个靶点的内容合并为单个文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat aid*.smi &gt; activaes.msi</div></pre></td></tr></table></figure>
<p><em>T.gondii</em>和<em>C.pavum</em>分别包含156个和89个活性化合物。你可以在这里<a href="/images/2017/smina/SMINA2.tar.gz">下载</a>合并好的文件。</p>
<h3 id="1-2-2-创建诱饵数据集"><a href="#1-2-2-创建诱饵数据集" class="headerlink" title="1.2.2 创建诱饵数据集"></a>1.2.2 创建诱饵数据集</h3><p>   <strong>该在线网站说只需要10min，实际上需要1-2天左右时间</strong><br>   由于这些靶点的无活性配体数量较少，我们使用诱饵数据库Database of Useful Decoys：Enhanced（DUDE）方法来从ZINC数据库中进行采样。这些诱饵被选择的方法为化学性质不相同（即和有活性的配体相比较不相似，认为是不结合的）。但分子质量，logP，旋转键和氢键受体供体这些简单的分子参数是相同的。</p>
<p>(a)使用<a href="http://dude.docking.org/generate" target="_blank" rel="external">DUDE</a>网站创建诱饵数据集,将会生成dude-decoys.tar.gz文件，里面包含50个参数匹配的诱饵。</p>
<p>(b)将诱饵结合进入单个文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat decoys/* | grep -v ligand &gt; decoys.msi</div></pre></td></tr></table></figure>
<p>点此<a href="/images/2017/smina/SMINA3.tar.gz">下载</a>decoys文件，(<em>T.gondii</em>诱饵和活性化合物。<em>C.pavum</em>诱饵和活性化合物)。</p>
<h3 id="1-2-3-生成三维结构"><a href="#1-2-3-生成三维结构" class="headerlink" title="1.2.3 生成三维结构"></a>1.2.3 生成三维结构</h3><p>  我们将使用开源软件RDKit利用2D SMILES生成3D构像</p>
<p>(a)将RDKit写入你的PYTHONPATH，并且执行<a href="/images/2017/smina/rdconf.py">rdconf.py</a>脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget http://bits.csb.pitt.edu/tdtCDPK1/rdconf.py</div><div class="line">chmod + x rdconf.py</div></pre></td></tr></table></figure>
<p>(b)每个active/decoy生成单一构像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rdconf.py --maxconfs 1 decoys.smi decoys.sdf</div><div class="line">rdconf.py --maxconfs 1 actives.smi actives.sdf</div></pre></td></tr></table></figure>
<p>(c)将文件合并</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat actives.sdf decoys.sdf &gt; combined.sdf</div></pre></td></tr></table></figure>
<blockquote>
<p>由于有两个文件，我们将<em>T.gondii</em>和<em>C.pavum</em>分别命令为gondii.sdf和parvum.sdf</p>
</blockquote>
<h2 id="1-3-对接"><a href="#1-3-对接" class="headerlink" title="1.3 对接"></a>1.3 对接</h2><p>我们使用SMINA通过对接化合物进入受体结构进行虚拟筛选,采用AutoDock Vina得分功能。由于我们对一个固定的受体对接，所以我们选择一个好的受体结构是非常重要的。我们将会使用CDPK1的测试集来模拟评价我们的对接工具和选择受体结构。</p>
<p>1.鉴定PDB中所有<em>C.parvum</em>和<em>T.gondii</em>文件，搜索’calcium-dependent protein kinase 1’,并且选择恰当的生物（organism.）</p>
<p>  <em>C. parvum</em>: 2QG5 2WEI 3DFA 3F3Z 3HKO 3IGO 3L19 3LIJ 3MWU 3NCG</p>
<p>  <em>T. gondii</em>: 3I79 3I7B 3I7C 3KU2 3N51 3NYV 3SX9 3SXF 3T3U 3T3V 3UPX 3UPZ 3V51 3V5P 3V5T 4M84</p>
<blockquote>
<p>由于教程较老，故和自己搜索有差异</p>
</blockquote>
<p>2.下载这些pdb文件,你可以用如下的简单方法，或者直接<a href="/images/2017/smina/SMINA4.tar.gz">下载</a>我下载好的。</p>
<p>将以下代码保存为脚本，例如<code>down.sh</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash  </span></div><div class="line">  </div><div class="line">str=<span class="string">"2QG5 2WEI 3DFA 3F3Z 3HKO 3IGO 3L19 3LIJ 3MWU 3NCG"</span>  </div><div class="line">arr=(<span class="variable">$&#123;str// / &#125;</span>)  </div><div class="line">  </div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$&#123;arr[@]&#125;</span>  </div><div class="line"><span class="keyword">do</span>  </div><div class="line">    wget https://files.rcsb.org/download/<span class="variable">$i</span>.pdb </div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>执行如下命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chmod +x down.sh</div><div class="line">./down.sh</div></pre></td></tr></table></figure>
<p>3.比对和提取结构。在pymol中打开靶标pdb文件。比对他们。除去水和原子。提取每个配体到自己的对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#pymol中执行</span></div><div class="line"><span class="keyword">from</span> glob <span class="keyword">import</span> glob</div><div class="line"><span class="keyword">for</span> fil <span class="keyword">in</span> glob(<span class="string">"*.pdb"</span>): cmd.load(fil)</div><div class="line">alignto</div><div class="line">remove solvent</div><div class="line">remove metal</div><div class="line">remove GOL</div><div class="line"><span class="comment">#选择配体BK1周围5埃外的小分子，并且删除，因为并未在结合位点内，不是配体</span></div><div class="line">select unligand,byres resname BK1 gap <span class="number">5</span> <span class="keyword">and</span> hetatm</div><div class="line">remove unligand</div><div class="line"><span class="comment">#选择配体</span></div><div class="line">select ligand,hetatm</div><div class="line">extract parvum,ligand</div><div class="line"><span class="comment">#保存配体</span></div><div class="line">save parvumlig.pdb,parvum</div><div class="line">remove ligand</div></pre></td></tr></table></figure>
<p>4.保存受体和配体文件，注意的是<code>3LI9</code>没有酶结构域，<code>3DFA</code>和<code>2QG5</code>为未结合态结构，综合考虑我们将其删除。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">remove <span class="number">3L</span>I9 <span class="keyword">and</span> <span class="number">3</span>DFA <span class="keyword">and</span> <span class="number">2</span>QG5</div></pre></td></tr></table></figure>
<p>保存(注意一下需要保存为python文件后<code>run</code>进行操作)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> name <span class="keyword">in</span> cmd.get_names():cmd.save(name + <span class="string">".pdb"</span> , name )</div></pre></td></tr></table></figure>
<p>5.将配体导入进单一文件，由于我们之前做了，该步骤无需做</p>
<p>6.对接测试集化合物到每个受体结构，例如:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">smina --seed 0 --autobox_ligand parvumlig.pdb -r 2WEI.pdb \</div><div class="line">-l combined.sdf -o 2WEI_docked.sdf.gz</div></pre></td></tr></table></figure>
<p>在这里我们制定了一个随机种子。结合盒子采用<code>autobox_ligand</code>设置，创建的盒子大小为对于提供的配体8埃缓冲。配体，受体和输出文件可以使用任意OpenBabel支持的格式。</p>
<p>7.获取每个化合物<a href="/images/2017/smina/2WEI_docked.txt">输出</a>得分最高的对接姿势。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sdsorter -sort minimizedAffinity -reduceconfs 1 2WEI_docked.sdf.gz \</div><div class="line">-<span class="built_in">print</span> -c &gt; 2WEI_docked.txt</div></pre></td></tr></table></figure>
<p>8.分析对接结果，原文是使用的R进行的分析，大家可以以下做参考，当然也可以依葫芦画瓢使用Python进行处理。</p>
<p>(a)R版本方法如下:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"pROC"</span>)</div><div class="line"><span class="keyword">library</span>(<span class="string">"pROC"</span>)</div><div class="line"></div><div class="line">rarr=list()</div><div class="line"><span class="keyword">for</span> (file <span class="keyword">in</span> Sys.glob(<span class="string">"*docked.txt"</span>)) &#123;</div><div class="line"> d = read.table(file,header=<span class="literal">T</span>)</div><div class="line"> r = roc(grepl(<span class="string">"active"</span>,d $Title) , d$minimizedAffinity,direction=<span class="string">"&gt;"</span>)</div><div class="line"> rarr[[length(rarr)+<span class="number">1</span>]]=r</div><div class="line">&#125;</div><div class="line">names(rarr) = Sys.glob(<span class="string">"*docked.txt"</span>)</div><div class="line"></div><div class="line"><span class="keyword">for</span> (n <span class="keyword">in</span> names(rarr)) &#123;</div><div class="line"> r = rarr[[n]]</div><div class="line"> a = auc(r,partial.auc=c(<span class="number">1</span>,<span class="number">.9</span>),partial.auc.correct= <span class="literal">T</span> )</div><div class="line"> s = sprintf(<span class="string">"%s %.4 f%.4f\n"</span> , sub(<span class="string">"_docked.txt"</span> ,<span class="string">""</span>,n),r$auc[<span class="number">1</span>],a[<span class="number">1</span>])</div><div class="line"> cat(s)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>图大致如下:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2017/smina/SMINA6.png" alt="图6" title="">
                </div>
                <div class="image-caption">图6</div>
            </figure>
<p>   AUC和Partial AUC的值分别为<code>0.8520</code>,<code>0.6485</code>。此数据运用的为官方数据，python版本为我自己写的方法，供参考</p>
<p>(b) ython版本如下:</p>
<p>首先我们使用<code>awk</code>处理一下原始文本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">awk <span class="string">'BEGIN&#123;FS='</span>_<span class="string">';OFS='</span>\t<span class="string">'&#125;&#123;print $1,$2&#125;'</span> 2WEI_docked.txt rocdata.txt</div><div class="line"><span class="comment">#打开文件，在Title后加type项</span></div></pre></td></tr></table></figure>
<p>得到的文件可以从这里<a href="/images/2017/smina/rocdata.txt">下载</a>，python脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*-coding:utf-8-*-</span></div><div class="line"><span class="comment">#python=3.x</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_curve, roc_auc_score</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="comment"># 读取数据</span></div><div class="line">df=pd.read_csv(<span class="string">'rocdata.txt'</span>,sep=<span class="string">'\t'</span>)</div><div class="line"></div><div class="line">df.loc[<span class="keyword">lambda</span> df: df.type==<span class="string">'active'</span>,[<span class="string">'type'</span>]]=<span class="string">'1'</span></div><div class="line">df.loc[<span class="keyword">lambda</span> df: df.type==<span class="string">'unactive'</span>,[<span class="string">'type'</span>]]=<span class="string">'0'</span></div><div class="line">df[<span class="string">'minimizedAffinity'</span>]=df[<span class="string">'minimizedAffinity'</span>]/<span class="number">-10.76520</span></div><div class="line">y=df[<span class="string">'type'</span>].astype(<span class="string">'int64'</span>)</div><div class="line">scores=df[<span class="string">'minimizedAffinity'</span>]</div><div class="line"></div><div class="line"><span class="comment"># ROC</span></div><div class="line">fpr,tpr,thresholds=roc_curve(y,scores,pos_label=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="comment">#auc值</span></div><div class="line">auc=roc_auc_score(df[<span class="string">'type'</span>].astype(<span class="string">'int64'</span>),scores)</div><div class="line"></div><div class="line"><span class="comment">#绘图</span></div><div class="line">plt.figure()</div><div class="line">plt.plot(fpr,tpr,color=<span class="string">'darkorange'</span>,lw=<span class="number">2</span>,label=<span class="string">'pavum ROC curve,auc %0.2f'</span> % auc)</div><div class="line">plt.xlim([<span class="number">0.0</span>,<span class="number">1.0</span>])</div><div class="line">plt.ylim([<span class="number">0.0</span>,<span class="number">1.05</span>])</div><div class="line">plt.plot([<span class="number">0</span>,<span class="number">1</span>],[<span class="number">0</span>,<span class="number">1</span>],color=<span class="string">'navy'</span>,lw=<span class="number">2</span>,linestyle=<span class="string">'--'</span>)</div><div class="line">plt.xlabel(<span class="string">'False Positive Rate'</span>)</div><div class="line">plt.ylabel(<span class="string">'True Positive Rate'</span>)</div><div class="line">plt.title(<span class="string">'2WEI ROC curve'</span>)</div><div class="line">plt.legend(loc=<span class="string">"lower right"</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2017/smina/SMINA9.png" alt="图9" title="">
                </div>
                <div class="image-caption">图9</div>
            </figure>
<h1 id="2-E-tenella-CDPK1-模型和-测试集预测"><a href="#2-E-tenella-CDPK1-模型和-测试集预测" class="headerlink" title="2. E.tenella CDPK1 模型和 测试集预测"></a>2. <em>E.tenella</em> CDPK1 模型和 测试集预测</h1><p>现在我们创建一个<em>E.tenella</em>模型来进行虚拟筛选和发展基于先前得分结果的用户自定义的得分功能。</p>
<h2 id="2-1-建模"><a href="#2-1-建模" class="headerlink" title="2.1 建模"></a>2.1 建模</h2><p>基于之前章节的对接结果，<em>T.gondii</em>在全局和结合位点的序列中是更加接近<em>E.tenella</em>的.3T3U是<em>T.gondii</em>最优得分性能的一个结构（AUC和早期经验性AUC评价），因此我们使用SWISS-Model构建swissmodel3T3U.pdb</p>
<h2 id="2-2-对接测试集"><a href="#2-2-对接测试集" class="headerlink" title="2.2 对接测试集"></a>2.2 对接测试集</h2><p>这里有提供<a href="/images/2017/smina/cdpk1_externaltestset.txt">22个化合物</a>和<a href="/images/2017/smina/tdt2014.xlsx">详细实验数据</a>作为模型的测试集</p>
<p>1.转化为SMILES格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">awk <span class="string">' NR&gt;1&#123;print $2, $1&#125; '</span> tdt2-challenge3-cdpk1_externaltestset.txt \</div><div class="line">&gt; testset.smi</div></pre></td></tr></table></figure>
<p>2.生成构像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rdconf.py --maxconfs 1 testset.smi testset.sdf</div></pre></td></tr></table></figure>
<p>3.对接测试集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">smina --autobox_ligand allligs.pdb -r swissmodel3T3U.pdb  \</div><div class="line">   -l ../testset.sdf -o testset_docked.sdf --seed 0</div></pre></td></tr></table></figure>
<p>4.选择和排序得分</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sdsorter -sort minimizedAffinity testset_docked.sdf -reduceconfs 1 \</div><div class="line">testset_docked_best.sdf -<span class="built_in">print</span> -c &gt; testset_default_ranking.txt</div></pre></td></tr></table></figure>
<p>最佳得分构像如下图</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/images/2017/smina/SMINA8.png" alt="图7" title="">
                </div>
                <div class="image-caption">图7</div>
            </figure>
<h2 id="2-3-用户自定义得分"><a href="#2-3-用户自定义得分" class="headerlink" title="2.3 用户自定义得分"></a>2.3 用户自定义得分</h2><p>我们发展了用户自定义得分功能用以<em>T.gondii</em>测试集参数化。增加到默认的得分功能上。</p>
<p>1.删除atom-types项目（如果考虑所有可能的原子类型组合，这将是一个非常大的项目），同样包括默认的第二Gaussian项目，他同样存在于默认得分之中。所有的权重均设为1.0</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">smina --print_terms | \</div><div class="line">  grep -v -E <span class="string">'atom_type|constant|num_|ligand_length'</span> &gt; allterms </div><div class="line"><span class="built_in">echo</span> <span class="string">"gauss(o=3,_w=2,_c=8)"</span> &gt;&gt; allterms </div><div class="line">sed -i <span class="string">'s/^/1.0 /'</span> allterms</div></pre></td></tr></table></figure>
<blockquote>
<p><code>grep -v -E</code>的用法比较少，<code>-v</code>表示不包含匹配文本的所有行，<code>-E</code>为启用正则表达式</p>
</blockquote>
<p>2.得分最高的构像3T3U测试集拿来进行比较,由于我这里只做了2WEI，所以实际上此步我用的2WEI</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 提取最高得分构像</span></div><div class="line">sdsorter -sort minimizedAffinity -reduceconfs 1 \</div><div class="line">    3T3U_docked.sdf.gz 3T3U_docked_single.sdf.gz</div><div class="line"><span class="comment"># 重新打分，不用再继续跑</span></div><div class="line">smina --custom_soring allterms --score_only </div><div class="line">    -l 3T3U_docked_single.sdf.gz -r 3T3U.pdb | \</div><div class="line">    grep <span class="string">"##"</span> | sed <span class="string">"s/##//"</span> | \</div><div class="line">    awk <span class="string">'&#123;print $1 ~ /_active/, $0&#125;'</span> &gt; allscores</div></pre></td></tr></table></figure>
<blockquote>
<p>原文档中最后一行为/active/，但是个人觉得并没有达到区分active和unactive的用途，故本人对其进行了修改。可以从此<a href="/images/2017/smina/allscores">下载文件</a>。</p>
</blockquote>
<p>3.作者使用R中的<code>rms</code>包和<strong>logistical</strong>回归来进行后向变量选择来契合活性数据的得分。为了防止过拟合，只选择p-值较低的功能（&lt;.0001）。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"rms"</span>)</div><div class="line"><span class="keyword">library</span>(rms)</div><div class="line">scores=read.table(<span class="string">"allscores"</span>,header=<span class="literal">T</span>)[c(-<span class="number">2</span>)]   <span class="comment">#remove Name  colum</span></div><div class="line">colnames(scores)[<span class="number">1</span>]=<span class="string">"activity"</span></div><div class="line">formula=reformulate(name(scores)[c(-<span class="number">1</span>)],respinse=<span class="string">"activity"</span>)</div><div class="line">fit=lrm(formula,data=scores,x=<span class="literal">T</span>,y=<span class="literal">T</span>)</div><div class="line">fit2=fastbw(fit,rule=<span class="string">"p"</span>,sls=<span class="number">0.0001</span>)</div><div class="line"><span class="keyword">for</span>(n <span class="keyword">in</span> names(fit2$coefficients))&#123;</div><div class="line">  cat(sprintf(<span class="string">"%f %s\n"</span>,fit2$coefficients[[n]],n))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>4.保存测定的系数coefficients以创建新的评分函数。因为项目名称中包含特征符，其在R中是无效命名，所以需要编辑输入以重新储存适当的terms，得分函数的结果如图下:</p>
<p>   <img src="/images/2017/smina/SMINA10.png" alt="图10"></p>
<p>5.通过将系数乘以每一项的平均值来创建该评分函数中每个项的贡献的平均估计</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">aves=apply(scores[name(coef(fit2))[-<span class="number">1</span>]],<span class="number">2</span>,mean)*coef(fit2)[-<span class="number">1</span>]</div><div class="line"><span class="keyword">for</span>(n <span class="keyword">in</span> names(aves))&#123;</div><div class="line">  cat(sprintf(<span class="string">"%f %s\n"</span>,aves[[n]],n))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>   结果如下图</p>
<p>   <img src="/images/2017/smina/SMINA11.png" alt="图11"></p>
<p>   疏水性，VDW，氢键和溶剂化为有利相互作用，非疏水性，排斥性和受体-受体为负相关作用。VDW和gauss具有非常强的权重，线性氢键和Lennard Jones氢键展示了一些权重。</p>
<p>4*.Python包实现，Python的scikit-learn中对于logistical并没有P-值，译者对与R也不是特别理解，不知道能否领会作者的含义，以下仅供参考。 我们采用scikit-learn包中的logistical回归，同时将数据为训练集（75%）与测试集，检测是否过拟合，若没有测试集效果也不错，就使用所有的作为训练集再次训练。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> linear_model</div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</div><div class="line"></div><div class="line"><span class="comment"># 首先将文件的两个空格，替换为一个空格，或者sep 写成`空格+`</span></div><div class="line">df=pd.read_table(<span class="string">'allscores'</span>,sep=<span class="string">' '</span>)</div><div class="line"></div><div class="line"><span class="comment"># 采用的为分层采样，以避免训练集和测试集不均匀的现象</span></div><div class="line">X_train,X_test,y_train,y_test=train_test_split(df.iloc[:,<span class="number">2</span>:],df[<span class="string">'type'</span>],test_size=<span class="number">0.15</span>,stratify=df[<span class="string">'type'</span>])</div><div class="line"></div><div class="line"><span class="comment"># sklearn是机器学习库，而非统计库，所以去掉不相关的feature的话可以使用l1 regularization，默认的阈值为0.0001，相同</span></div><div class="line">regr=linear_model.LogisticRegression(penalty=<span class="string">'l1'</span>)</div><div class="line">regr.fit(X_train,y_train)</div><div class="line"></div><div class="line">print(<span class="string">'Coefficients:%s,intercept %s'</span>%(regr.coef_,regr.intercept_))</div><div class="line">print(<span class="string">'Score: %.2f'</span> % regr.score(X_test,y_test))</div></pre></td></tr></table></figure>
<p>结果如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Coefficients:[[-0.03864204  0.40028821 -0.00676393 -0.09159704 -0.0345586  -0.10145013</div><div class="line">   2.79993056  0.38033068  0.          0.         -0.00837466  0.</div><div class="line">   0.04403177]],intercept [-3.04932666]</div><div class="line">Score: 0.82</div></pre></td></tr></table></figure></p>
<p>译者计算出来和原作者计算出来有差异，主要就是hydrophobic和non_hydrophobic项两者的权重都为负数,项和值上也有差异。接下来我们乘上平均值得到最终权重。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">df.iloc[:,<span class="number">2</span>:].mean()*regr.coef_[<span class="number">0</span>]</div></pre></td></tr></table></figure>
<p>结果如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">gauss(o=0,_w=0.5,_c=8)                          -2.447950</div><div class="line">repulsion(o=0,_c=8)                              0.602891</div><div class="line">hydrophobic(g=0.5,_b=1.5,_c=8)                  -0.331807</div><div class="line">non_hydrophobic(g=0.5,_b=1.5,_c=8)              -5.150272</div><div class="line">vdw(i=6,_j=12,_s=1,_^=100,_c=8)                 20.386651</div><div class="line">non_dir_h_bond_lj(o=-0.7,_^=100,_c=8)            1.535267</div><div class="line">non_dir_anti_h_bond_quadratic(o=0,_c=8)          0.205500</div><div class="line">non_dir_h_bond(g=-0.7,_b=0,_c=8)                 0.000000</div><div class="line">acceptor_acceptor_quadratic(o=0,_c=8)            0.000000</div><div class="line">donor_donor_quadratic(o=0,_c=8)                  0.000000</div><div class="line">gauss(o=3,_w=2,_c=8)                           -13.474894</div><div class="line">electrostatic(i=2,_^=100,_c=8)                   0.000000</div><div class="line">ad4_solvation(d-sigma=3.6,_s/q=0.01097,_c=8)     0.797093</div></pre></td></tr></table></figure></p>
<p>6.评价这个新的得分函数，使用这个新的得分函数fitscore（<strong>个人觉得是第一次得出的权重进行的计算，因为我用第二次的权重进行计算数值很大，此处待考</strong>）除了重新打分最高的对接姿势以外，我们重新打分和重新排序所有的对接姿势。值得注意的是这个得分函数是预测的活性而不是亲和力。越大的positive值表示的是复合物可能具有活性的概率更大，所以复合物在选择最佳构像排序的时候需要逆转数字顺序。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">smina --score_only -r 3T3U.pdb -l 3T3U_docked_single.sdf.gz \</div><div class="line">        --custom_scoring fitscore -o 3T3U_docked_single_rescore.sdf.gz</div><div class="line"></div><div class="line">sdsorter  -<span class="built_in">print</span> -c 3T3U_docked_single_rescore.sdf.gz &gt; 3T3U_docked_single_rescore.txt</div><div class="line"></div><div class="line">smina --score_only -r 3T3U.pdb -l 3T3U_docked.sdf.gz \</div><div class="line">         --custom_scoring fitscore -o 3T3U_dcoked_rescore.sdf.gz</div><div class="line"></div><div class="line">sdsorter -reversesort minimizedAffinity -reduceconfs 1 -<span class="built_in">print</span> -c \</div><div class="line">          3T3U_docked_rescore.sdf.gz &gt;3T3U_docked_rescore.txt</div></pre></td></tr></table></figure>
<blockquote>
<p>译者在做的时候对第6条不是很理解</p>
</blockquote>
<p>7.使用新的得分函数对接<code>E.tenella</code>化合物集:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">smina --custom_scoring fitscore --score_only -l testset_docked.sdf \</div><div class="line">         -r swissmodel3T3U.pdb -o testset_rescored.sdf</div><div class="line">sdsorter -<span class="built_in">print</span> -c testset_rescored.sdf -reversesort minimizedAffinity \</div><div class="line">           -reduceconfs 1 testset_rescored_best.sdf \</div><div class="line">           &gt; testset_custom_ranking.txt</div></pre></td></tr></table></figure>
<p>   应该使用在这个测试集上表现更好的评分函数来进行完整的虚拟筛选选择化合物，结果可以从此<a href="images/SMINA5.tar.gz">下载</a></p>
<blockquote>
<p>译者认为自定义得分并未达到非常好的效果，可以进一步优化</p>
</blockquote>
<h1 id="3-虚拟筛选"><a href="#3-虚拟筛选" class="headerlink" title="3.虚拟筛选"></a>3.虚拟筛选</h1><p>  已经阐明精心设计的自定义得分可以很好的应用在<em>E.tenella</em>结构模型，我们进行筛选eMolecules化合物库。需要注意的是我们的自定义得分函数并不使用于对接，而是参数化预测已经对接好的姿势的活性。</p>
<p>1.下载eMolecules数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">wget http://downloads.emolecules.com/ordersc/2017-11-01/parent.smi.gz</div><div class="line">gunzip parent.smi.gz</div></pre></td></tr></table></figure>
<p>2.根据环境切割不同大小。例如，10000每块进行切割</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">split -n 1/10000 parent.smi -d -a 4 split_</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> split*; <span class="keyword">do</span> mv <span class="variable">$i</span> <span class="variable">$&#123;i&#125;</span>.smi; <span class="keyword">done</span></div></pre></td></tr></table></figure>
<p>3.生成构像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rdconf.py --maxconfs 1 split_0000.smi split_0000.sdf.gz</div></pre></td></tr></table></figure>
<p>4.对接每个块</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">smina --autobox_ligand allligs.pdb -r swissmodel3T3U.pdb \</div><div class="line">          -l split_0000.sdf.gz -o docked_0000.sdf.gz --seed 0</div></pre></td></tr></table></figure>
<p>5.对获得的最高排名姿势使用默认的得分和自定义得分进行评价</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sdsorter -sort minimizedAffinity -reduceconfs 1 -nbest 100 \</div><div class="line">        docked_0000.sdf.gz best_default_0000.sdf.gz</div><div class="line">smina --custom_scoring fitscore --score_only -l docked_0000.sdf.gz \</div><div class="line">        -r swissmodel3T3U.pdb -o rescored_0000.sdf.gz</div></pre></td></tr></table></figure>
<p>6.将对接姿势放入一个文件并排序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">zcat bets_default_*.sdf.gz | gzip &gt; best_default.sdf.gz</div><div class="line">zcat best_custom_*.sdf.gz | gzip &gt; best_custom.sdf.gz</div><div class="line">sdsorter -sort- minimizedAffinity best_default.sdf.gz \</div><div class="line">        -nbest 1000 top1000_default.sdf.gz -<span class="built_in">print</span> -c \ </div><div class="line">         &gt; top1000_default.txt</div><div class="line">sdsorter -reversesort minimizedAffinity best_custom.sdf.gz \</div><div class="line">        -nbest 1000 top1000_custom.sdf.gz -<span class="built_in">print</span> -c \</div><div class="line">        &gt; top1000_custom.txt</div></pre></td></tr></table></figure>
<p>参考文献:<br>Ojo KK, Larson ET, Keyloun KR, Castaneda LJ, Derocher AE, Inampudi KK, Kim JE, Arakaki TL, Murphy RC, Zhang L, Napuli AJ, Maly DJ, Verlinde CL, Buckner FS, Parsons M, Hol WG, Merritt EA, Van Voorhis WC. (2010) Toxoplasma gondii calcium-dependent protein kinase 1 is a target for selective kinase inhibitors. Nat Struct Mol Biol. 17:602-7. PMID: 20436472 PMCID: PMC2896873</p>
<p>Murphy RC, Ojo KK, Larson ET, Castellanos-Gonzalez A, Perera BG, Keyloun KR, Kim JE, Bhandari JG, Muller NR, Verlinde CL, White AC, Merritt EA, Van Voorhis WC, Maly DJ. (2010) Discovery of Potent and Selective Inhibitors of Calcium-Dependent Protein Kinase 1 (CDPK1) from C. parvum and T. gondii. (2010) ACS Med Chem Lett. 1(7):331-335. PMID: 21116453 PMCID: PMC2992447</p>
<p>Johnson SM, Murphy RC, Geiger JA, Derocher A, Zhang Z, Ojo K, Larson E, Perera BG, Dale E, He P, Fox A, Mueller N, Merritt EA, Fan E, Reid M, Parsons M, Van Voorhis WC, Maly DJ. (2012) Development of Toxoplasma gondii Calcium-Dependent Protein Kinase 1 (TgCDPK1) Inhibitors with Potent Anti-Toxoplasma Activity. J Med Chem. 55(5):2416-26. PMID: 22320388 PMCID: PMC3306180</p>
<p>Larson ET, Ojo KK, Murphy RC, Johnson SM, Zhang Z, Kim JE, Leibly DJ, Fox AM, Reid MC, Dale EJ, Perera BG, Kim J, Hewitt SN, Hol WG, Verlinde CL, Fan E, Van Voorhis WC, Maly DJ, Merritt EA. (2012) Multiple Determinants for Selective Inhibition of Apicomplexan Calcium-Dependent Protein Kinase CDPK1. J Med Chem. 55(6):2803-10. PMID: 22369268 PMCID: PMC3336864</p>
<p>Ojo KK, Pfander C, Mueller NR, Burstroem C, Larson ET, Bryan CM, Fox AMW, Reid MC, Johnson SM, Murphy RC, Kennedy M, Henning Mann H, Leibly DJ, Hewitt SN, Verlinde CLMJ. Kappe S, Merritt EA, Maly DJ, Billker O, Van Voorhis WC. (2012) Transmission of malaria to mosquitoes blocked by bumped kinase inhibitors.  J. Clin. Invest. 122(6):2301–2305. doi: 10.1172/JCI61822  PMID:22565309 PMCID: PMC3366411</p>
<p>Zhang Z, Ojo KK, Johnson SM, Larson ET, He P, Geiger JA, Castellanos-Gonzalez A, White AC Jr, Parsons M, Merritt EA, Maly DJ, Verlinde CL, Van Voorhis WC, Fan E. (2012) Benzoylbenzimidazole-based selective inhibitors targeting Cryptosporidium parvum and Toxoplasma gondii calcium-dependent protein kinase-1. Bioorg Med Chem Lett. 22:5264-7. PMID: 22795629 PMCID: PMC3420979</p>
<p>Castellanos-Gonzalez A, A. White AC Jr, Ojo KK, Vidadala R, Zhang Z, Reid MC, Fox AMW, Keyloun KR, Rivas K, Irani A, Dann SM, Fan E, Maly DJ,  Wesley C Van Voorhis. (2013). A novel Calcium Dependent Protein Kinase Inhibitor as a lead compound for treating Cryptosporidiosis. J Infect. Dis. PMID: 23878324  2013 Jul 21. [Epub ahead of print]</p>
<p>Ojo KK, Eastman RT, Vidadala R, Zhang Z, Rivas KL, Choi R, Lutz JD, Reid MC, Fox AMW, Hulverson MA, Kennedy M, Isoherranen N, Kim LM, Comess KM, Kempf DJ, Verlinde CLMJ, Su X-Z, Kappe S, Maly DJ, Fan E, &amp; Van Voorhis WC. (2013) Specific inhibitor of PfCDPK4 blocks malaria transmission: Chemical-genetic validation. J Infect Dis. 2013 Oct 10. [Epub ahead of print] PMID: 24123773</p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-11-12T06:29:44.946Z" itemprop="dateUpdated">2017-11-12 14:29:44</time>
</span><br>


        
        链接：<a href="/5.html" target="_blank" rel="external">http://kangsgo.com/5.html</a>
        
    </div>
    <footer>
        <a href="http://kangsgo.com">
            <img src="/img/avatar.jpg" alt="kangsgo">
            kangsgo
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dock/">dock</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/5.html&title=《SMINA教程以CDPK1为例》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/5.html&title=《SMINA教程以CDPK1为例》 — 小康博客&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/5.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《SMINA教程以CDPK1为例》 — 小康博客&url=http://kangsgo.com/5.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/5.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/6.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">使用python得到TCGA表格</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/4.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Anaconda虚拟环境的构建与包管理</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>kangsgo &copy; 2015 - 2017</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://kangsgo.com/5.html&title=《SMINA教程以CDPK1为例》 — 小康博客&pic=http://kangsgo.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://kangsgo.com/5.html&title=《SMINA教程以CDPK1为例》 — 小康博客&source=Gromacs,Dock,Martini,Chimera,Pymol" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://kangsgo.com/5.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《SMINA教程以CDPK1为例》 — 小康博客&url=http://kangsgo.com/5.html&via=http://kangsgo.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://kangsgo.com/5.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAAAAAAZai4+AAABU0lEQVR42u3aSw7DIBAEUd//0s42kmVSzUcRTLGyEmKeF6Exw3Xhdj/a9+dvPd/6TGuyZB3EuputzXqjPL/lY8mSVZlFbtdGtPvzsWTJkkWG4Wge27JkyeqbIEgY/2HekiVrcxb/Y6evpsvX8rJkHcHiuzrj10v2t2TJ2px1h63vFTceRZasYqw0btPlL49hWbIqs8bLlvyalGpkyarJIktk3mduuUWWrDosEqX8ycYX0LJk1WTxeCYlzHYMxzOWLFnlWWkJMy2foNiWJaskKz1mt6Jsg/auZMkqyUq3bkmEo3dVWbJKstLYnrsV9aPmI0vW0ay+owD8BTWdbmTJqslKl7Z93IXnBGXJOog1vvUzd0KRJasyKy1wzp2BgrOBsmTJCkssI8cXZMmSxYuRJJ75g8mSJYsvfMlveaijmo8sWQVYabGE3IiH97TTCrJk7cr6AMqapn7SvuCxAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
